{"version":3,"sources":["webpack:///./src/views/personal/info/index.vue?907f","webpack:///./src/api/user.js","webpack:///./src/views/personal/info/index.vue","webpack:///src/views/personal/info/index.vue","webpack:///./src/views/personal/info/index.vue?54e3","webpack:///./src/views/personal/info/index.vue?6e4d"],"names":["getUserInfo","request","url","method","update","data","changePassword","changeIcon","icon","render","_vm","this","_c","_self","staticClass","attrs","action","header","handleAvatarSuccess","beforeAvatarUpload","user","ref","rules","model","value","realName","callback","$$v","$set","expression","cellphone","email","staticStyle","on","$event","_v","reset","staticRenderFns","name","validator1","rule","length","reg","test","Error","validator2","getToken","process","id","undefined","required","message","trigger","min","max","validator","methods","res","file","isJPG","type","indexOf","isLt2M","size","$message","error","then","statusCode","msg","form","$refs","validate","valid","store","commit","created","component"],"mappings":"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","file":"js/chunk-3beb9024.40b7dedc.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=7c199ee0&prod&scoped=true&lang=css\"","import request from '../utils/request'\n\nexport function getUserInfo() {\n    return request({\n        url: '/permission/userinfo',\n        method: 'get'\n    })\n}\n\nexport function update(data) {\n    return request({\n        url: '/system/user/update',\n        data: data,\n        method: 'post'\n    })\n}\n\nexport function changePassword(data) {\n    return request({\n        url: '/system/user/change',\n        data: data,\n        method: 'post'\n    })\n}\n\nexport function changeIcon(icon) {\n    return request({\n        url: '/system/user/changeIcon/' + icon,\n        method: 'get'\n    })\n}\n\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"inner_container\"},[_c('div',{staticClass:\"user-form\"},[_c('div',{staticClass:\"avatar\",attrs:{\"title\":\"点击更换头像\"}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":_vm.action,\"show-file-list\":false,\"headers\":_vm.header,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.user.icon)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.user.icon,\"alt\":\"\"}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1),_c('br'),_c('el-form',{ref:\"form\",attrs:{\"rules\":_vm.rules,\"model\":_vm.user,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名称:\",\"prop\":\"realName\"}},[_c('el-input',{model:{value:(_vm.user.realName),callback:function ($$v) {_vm.$set(_vm.user, \"realName\", $$v)},expression:\"user.realName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"电话:\",\"prop\":\"cellphone\"}},[_c('el-input',{model:{value:(_vm.user.cellphone),callback:function ($$v) {_vm.$set(_vm.user, \"cellphone\", $$v)},expression:\"user.cellphone\"}})],1),_c('el-form-item',{attrs:{\"label\":\"邮箱:\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.user.email),callback:function ($$v) {_vm.$set(_vm.user, \"email\", $$v)},expression:\"user.email\"}})],1),_c('el-form-item',[_c('el-button',{staticStyle:{\"font-size\":\"16px\"},attrs:{\"type\":\"success\"},on:{\"click\":function($event){return _vm.update('form')}}},[_vm._v(\" 修改\")]),_c('el-button',{staticStyle:{\"font-size\":\"16px\"},attrs:{\"type\":\"warning\"},on:{\"click\":_vm.reset}},[_vm._v(\" 重置\")])],1)],1)],1)])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <div class=\"user-form\">\n          <div class=\"avatar\" title=\"点击更换头像\">\n            <el-upload\n                class=\"avatar-uploader\"\n                :action=\"action\"\n                :show-file-list=\"false\"\n                :headers=\"header\"\n                :on-success=\"handleAvatarSuccess\"\n                :before-upload=\"beforeAvatarUpload\">\n              <img v-if=\"user.icon\" :src=\"user.icon\" class=\"avatar\" alt=\"\">\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload>\n          </div>\n          <br>\n          <el-form ref=\"form\" :rules=\"rules\" :model=\"user\" label-width=\"100px\">\n            <el-form-item label=\"用户名称:\" prop=\"realName\">\n              <el-input v-model=\"user.realName\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"电话:\" prop=\"cellphone\">\n              <el-input v-model=\"user.cellphone\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"邮箱:\" prop=\"email\">\n              <el-input v-model=\"user.email\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"success\" style=\"font-size: 16px;\"  @click=\"update('form')\"> 修改</el-button>\n              <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"reset\"> 重置</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {getUserInfo, update, changeIcon} from \"@/api/user\";\nimport {getToken} from \"@/utils/auth\";\nimport store from \"@/store\";\n\nexport default {\n  name: \"index\",\n  data() {\n    let validator1 = (rule, value, callback) => {\n      if (value.length === 0) {\n        callback()\n        return\n      }\n      let reg = /^1[3456789]\\d{9}$/\n      if (!reg.test(value)) {\n        callback(new Error())\n      } else {\n        callback()\n      }\n    }\n    let validator2 = (rule, value, callback) => {\n      if (value.length === 0) {\n        callback()\n        return\n      }\n      let reg = /^[0-9a-zA-Z_.-]+[@][0-9a-zA-Z_.-]+([.][a-zA-Z]+){1,2}$/;\n      if (!reg.test(value)) {\n        callback(new Error())\n      } else {\n        callback()\n      }\n    }\n    return {\n      header: {\n        \"_ut\": getToken()\n      },\n      action: process.env.VUE_APP_BASE_API + \"/permission/upload\",\n      user: {\n        id: undefined,\n        realName: '',\n        icon: undefined,\n        cellphone: '',\n        email: ''\n      },\n      rules: {\n        realName: [\n          {required: true, message: '名称不能为空', trigger: 'change'},\n          {min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'change'}\n        ],\n        cellphone: [\n          {validator: validator1, message: \"请输入正确的手机号\", trigger: 'change'}\n        ],\n        email: [\n          {validator: validator2, message: \"请输入正确的邮箱\", trigger: 'change'}\n        ]\n      }\n    }\n  },\n  methods: {\n    async handleAvatarSuccess(res) {\n      await this.changeIcon(res.data)\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type.indexOf('image/') !== -1;\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('只能上传图片');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    async changeIcon(icon) {\n      changeIcon(icon).then(res => {\n        if (res.statusCode === 200) {\n          this.$message({\n            message: res.msg,\n            type: 'success'\n          });\n          this.reset()\n        }\n      })\n    },\n    update(form) {\n      this.$refs[form].validate((valid) => {\n        if (valid) {\n          update(this.user).then(res => {\n            store.commit('SET_USER_NAME', res.data.realName)\n            this.$message({\n              message: res.msg,\n              type: 'success'\n            });\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      });\n    },\n    async reset() {\n      const {data} = await getUserInfo()\n      if (data.icon) {\n        data.icon = process.env.VUE_APP_IMG_PREFIX + data.icon\n      }\n      this.user = data\n      store.commit('SET_USER_ICON', this.user.icon)\n    }\n  },\n  created() {\n    this.reset()\n  }\n}\n</script>\n\n<style scoped>\n.user-form {\n  width: 400px;\n  margin: 0 auto;\n}\n\n.avatar, .avatar-uploader {\n  width: 80px;\n  height: 80px;\n  margin: 0 auto;\n}\n\n.avatar-uploader i {\n  line-height: 80px;\n  text-align: center;\n  margin: 0 32px;\n}\n\n.avatar-uploader {\n  border: 1px dashed #d9d9d9;\n}\n\n.avatar-uploader:hover {\n  border-color: #409EFF;\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=7c199ee0&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=7c199ee0&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c199ee0\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}