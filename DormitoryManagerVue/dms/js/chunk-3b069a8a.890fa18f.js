(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b069a8a"],{"1c79":function(t,a,e){},"6f24":function(t,a,e){"use strict";e("1c79")},"8ecf":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"fullscreen-container"},[a("dv-border-box-11",{staticClass:"dashboard-container",attrs:{title:"滇西科技师范学院"}},[a("div",{staticClass:"main-content"},[a("div",{staticClass:"left-section"},[a("dv-border-box-11",{staticClass:"notice-container",staticStyle:{height:"100%"},attrs:{backgroundColor:"rgba(28, 43, 75,0.5)",title:"最新公告"}},[a("div",{staticClass:"notice-content"},[t._l(t.noticeConfig.data,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"notice-row"},[a("span",{staticClass:"notice-label notice-title"},[t._v("发布人员：")]),a("span",{staticClass:"notice-value notice-title"},[t._v(t._s(e.user.realName))])]),a("div",{staticClass:"notice-row"},[a("span",{staticClass:"notice-label notice-title"},[t._v("发布时间：")]),a("span",{staticClass:"notice-value notice-title"},[t._v(t._s(t.formatTime(e.time)))])]),a("dv-border-box-5",[a("div",{staticClass:"notice-textarea"},[t._v(" "+t._s(e.msg)+" ")])])],1)})),t.noticeConfig.data.length?t._e():a("div",{staticClass:"empty-tip"},[t._v(" "+t._s(t.loading?"数据加载中...":"暂无最新公告")+" ")])],2)]),a("dv-border-box-8",{staticStyle:{height:"100%"},attrs:{backgroundColor:"rgba(28, 43, 75,0.5)"}},[a("div",{ref:"studentPie",staticClass:"pie-chart-container"})])],1),a("div",{staticClass:"center-section"},[a("dv-border-box-8",{staticStyle:{height:"100%"},attrs:{color:["transparent","transparent"]}}),a("dv-border-box-8",{staticStyle:{height:"100%"},attrs:{backgroundColor:"rgba(28, 43, 75,0.5)"}},[a("div",{attrs:{id:"stackedLine"}})])],1),a("div",{staticClass:"right-section"},[a("dv-border-box-8",{staticStyle:{height:"100%"},attrs:{backgroundColor:"rgba(28, 43, 75,0.5)"}},[a("dv-scroll-board",{key:t.scrollBoardKey,staticStyle:{width:"calc(100% - 20px)",height:"calc(100% - 20px)",margin:"10px"},attrs:{config:t.scrollBoardConfig}},[0===t.scrollBoardConfig.data.length?a("div",{staticClass:"empty-tip"},[t._v(" "+t._s(t.loading?"数据加载中...":"暂无请假记录")+" ")]):t._e()])],1),a("dv-border-box-8",{staticStyle:{height:"100%"},attrs:{backgroundColor:"rgba(28, 43, 75,0.5)"}},[a("div",{ref:"regMonthPie",staticClass:"pie-chart-container"})])],1)])]),a("div",{staticClass:"float-button",on:{click:t.handleBack}},[t._m(0)])],1)},o=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"button-content"},[a("i",{staticClass:"el-icon-back"},[t._v(" 返回 ")])])}],n=(e("14d9"),e("e9f5"),e("ab43"),e("2b0e")),s=e("6c29"),r=e("313e"),l=e("5a0c"),c=e.n(l),d=e("5992"),h=e.n(d),f=e("0bb4"),g=(e("8757"),e("49e5")),u=e("21f4");n["default"].component("animated-number",h.a),n["default"].use(s["a"]);var m={data(){return{scrollBoardKey:0,loading:!1,listQuery:{page:1,rows:99999,entity:{}},noticeConfig:{data:[]},scrollBoardConfig:{header:["姓名","班级","房间号"],data:[],index:!1,columnWidth:[150],align:["center"]},facultyData:[],regMonthData:[],colors:["#4FFA6E","#FFC233","#6E8BFF","#FF7A45","#A36EFF"]}},methods:{handleBack(){this.$router.push("/")},async listData(){try{this.loading=!0,this.scrollData(),this.noticeData(),this.fetchFacultyData()}finally{this.loading=!1}},async fetchFacultyData(){const{data:t}=await Object(g["countByFaculty"])();this.facultyData=t.map((t,a)=>{var e;return{value:t.count,name:null===(e=t.faculty)||void 0===e?void 0:e.name,itemStyle:{color:this.colors[a%this.colors.length]}}})},async fetchRegMonth(){const{data:t}=await Object(g["countByRegistrationMonth"])();this.regMonthData=t.map((t,a)=>({value:t.count,name:t.registrationMonth,itemStyle:{color:this.colors[a%this.colors.length]}}))},async noticeData(){const{data:t}=await Object(f["getNew"])();this.noticeConfig.data=t},processChartData(t){const a=t.sort((t,a)=>c()(t.month).valueOf()-c()(a.month).valueOf()),e=a.map(t=>t.month),i=[{name:"请假数量",data:a.map(t=>t.count),type:"line",smooth:!0}];this.updateChartConfig(e,i)},updateChartConfig(t,a){const e={title:{text:"每月请假数量趋势",textStyle:{color:"#fff",fontSize:16},left:"center"},tooltip:{trigger:"axis",formatter:t=>{const a=t[0].axisValue;return t.map(t=>`\n          <div style="display: flex; align-items: center">\n            <span style="display:inline-block;width:8px;height:8px;border-radius:50%;background:${t.color};margin-right:5px"></span>\n            ${t.seriesName}: ${t.value}次\n          </div>\n        `).join("")+`<div>${a}</div>`}},legend:{data:a.map(t=>t.name),textStyle:{color:"#fff"},bottom:10},grid:{top:60,bottom:80,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t,axisLabel:{color:"#fff",formatter:t=>c()(t).format("YYYY-MM")},axisLine:{lineStyle:{color:"#fff"}}},yAxis:{type:"value",min:0,minInterval:1,axisLabel:{color:"#fff",formatter:"{value} 次"},splitLine:{lineStyle:{color:"rgba(255,255,255,0.1)"}},axisLine:{lineStyle:{color:"#fff"}}},series:a.map((t,a)=>({...t,lineStyle:{width:3,shadowColor:"rgba(79,250,110,0.5)",shadowBlur:12},itemStyle:{color:"#4FFA6E"},areaStyle:{color:new r["a"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(79,250,110,0.4)"},{offset:1,color:"rgba(79,250,110,0.05)"}])}}))};this.myChart.setOption(e,!0),this.myChart.hideLoading()},getAreaColor(t){const a=["rgba(79,250,110,0.3)","rgba(255,194,51,0.3)","rgba(255,109,74,0.3)","rgba(106,139,255,0.3)"];return a[t]},async scrollData(){const{data:t}=await Object(g["all"])(),a=t.map(t=>{var a,e;return[t.name,null===(a=t.faculty)||void 0===a?void 0:a.name,null===(e=t.room)||void 0===e?void 0:e.number]});this.$set(this.scrollBoardConfig,"data",a),this.scrollBoardKey=Date.now()},async initPieCharts(){const t=r["b"](this.$refs.studentPie);console.log(this.facultyData),t.setOption({title:{text:"学院人数占比",textStyle:{color:"#fff",fontSize:14},left:"left"},tooltip:{trigger:"item",formatter:"{b}: {c}人 ({d}%)"},series:[{type:"pie",radius:["0%","70%"],center:["50%","50%"],data:this.facultyData,label:{formatter:({name:t,percent:a})=>`${t}\n${a.toFixed(1)}%`,fontSize:12,color:"#fff",rich:{name:{fontSize:12},percent:{fontSize:14,color:"#4FFA6E"}}},labelLine:{show:!0,length:20,smooth:.2}}]});const a=r["b"](this.$refs.regMonthPie);a.setOption({title:{text:"入学日期占比",textStyle:{color:"#fff",fontSize:14},left:"right"},tooltip:{trigger:"item",formatter:"{b}: {c}次 ({d})"},series:[{type:"pie",radius:["0%","70%"],center:["50%","50%"],data:this.regMonthData,label:{formatter:({name:t,percent:a})=>`${t}\n${a.toFixed(0)}%`,fontSize:12,color:"#fff",rich:{name:{fontSize:12},percent:{fontSize:14,color:"#4FFA6E"}}},labelLine:{show:!0,length:20,smooth:.2}}]})},async fetchScoreTrend(){try{const{data:t}=await Object(u["selectByTime"])();t&&t.length>0?this.processChartData(t):this.myChart.clear()}catch(t){this.myChart.showLoading("default",{text:"数据加载失败"})}},formatTime(t){return c()(t).format("YYYY-MM-DD HH:mm")}},async mounted(){await this.fetchFacultyData(),await this.fetchRegMonth(),this.$nextTick(()=>{this.initPieCharts()}),this.myChart=r["b"](document.getElementById("stackedLine")),window.addEventListener("resize",()=>this.myChart.resize()),this.fetchScoreTrend()},created(){this.listData()}},b=m,y=(e("6f24"),e("2877")),p=Object(y["a"])(b,i,o,!1,null,"8eacda4c",null);a["default"]=p.exports}}]);
//# sourceMappingURL=chunk-3b069a8a.890fa18f.js.map