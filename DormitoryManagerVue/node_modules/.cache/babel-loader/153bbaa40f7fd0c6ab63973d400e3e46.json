{"remainingRequest":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js!G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\src\\views\\manage\\dayApplicationApproval\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\src\\views\\manage\\dayApplicationApproval\\index.vue","mtime":1743690156936},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\babel.config.js","mtime":1626253806000},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1762330415881},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1762330415853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgZ2V0Q291bnNlbG9yUGVuZGluZ0FwcGxpY2F0aW9ucywgYXBwcm92ZUJ5Q291bnNlbG9yLCBnZXRCeUNsYXNzTmFtZSwgZ2V0QnlTdHVkZW50TmFtZSwgZ2V0QnlTdHVkZW50Tm9BbmRTdGF0dXMsIGdldEFwcHJvdmVkQXBwbGljYXRpb25zIH0gZnJvbSAnQC9hcGkvbGVhdmVBcHBsaWNhdGlvbic7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYXBwbGljYXRpb25zOiBbXSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHNlYXJjaENsYXNzOiAnJywKICAgICAgc2VhcmNoTmFtZTogJycsCiAgICAgIHNlYXJjaFN0dWRlbnRObzogJycKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaFBlbmRpbmdBcHBsaWNhdGlvbnMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGZldGNoUGVuZGluZ0FwcGxpY2F0aW9ucygpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRDb3Vuc2Vsb3JQZW5kaW5nQXBwbGljYXRpb25zKCk7CiAgICAgICAgY29uc29sZS5sb2coJ+WujOaVtOWTjeW6lDonLCByZXMpOwoKICAgICAgICAvLyDkv67mlLnliKTmlq3mnaHku7blkozmlbDmja7ot6/lvoQKICAgICAgICBpZiAoKHJlcyA9PT0gbnVsbCB8fCByZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlcy5zdGF0dXNDb2RlKSA9PT0gMjAwICYmIEFycmF5LmlzQXJyYXkocmVzLmRhdGEpKSB7CiAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9ucyA9IHJlcy5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2coJ+WkhOeQhuWQjueahOaVsOaNrjonLCB0aGlzLmFwcGxpY2F0aW9ucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoKHJlcyA9PT0gbnVsbCB8fCByZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlcy5tc2cpIHx8ICfmlbDmja7moLzlvI/lvILluLgnKTsgLy8g5L2/55SobXNn5a2X5q61CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+ivt+axguW8guW4uDonLCBlcnJvci5yZXNwb25zZSB8fCBlcnJvcik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnJvci5tZXNzYWdlIHx8ICfor7fmsYLlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGhhbmRsZUFwcHJvdmUocm93KSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5L2/55So5bCB6KOF5aW955qEQVBJ5pa55rOVCiAgICAgICAgYXdhaXQgYXBwcm92ZUJ5Q291bnNlbG9yKHJvdy5hcHBseUlkKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WuoeaJueaIkOWKnycpOwogICAgICAgIC8vIOWIt+aWsOWIl+ihqOaVsOaNrgogICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hQZW5kaW5nQXBwbGljYXRpb25zKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZTsKICAgICAgICBjb25zb2xlLmVycm9yKCflrqHmibnlpLHotKU6JywgZXJyb3IpOwogICAgICAgIC8vIOaYvuekuuabtOivpue7hueahOmUmeivr+S/oeaBrwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoKChfZXJyb3IkcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlID09PSB2b2lkIDAgfHwgKF9lcnJvciRyZXNwb25zZSA9IF9lcnJvciRyZXNwb25zZS5kYXRhKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZS5tc2cpIHx8ICflrqHmibnmk43kvZzlpLHotKUnKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHNlYXJjaEJ5Q2xhc3MoKSB7CiAgICAgIGlmICghdGhpcy5zZWFyY2hDbGFzcykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+36L6T5YWl54+t57qn5ZCN56ewJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlU2VhcmNoKCgpID0+IGdldEJ5Q2xhc3NOYW1lKHRoaXMuc2VhcmNoQ2xhc3MpKTsKICAgIH0sCiAgICBhc3luYyBzZWFyY2hCeU5hbWUoKSB7CiAgICAgIGlmICghdGhpcy5zZWFyY2hOYW1lKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fovpPlhaXlrabnlJ/lp5PlkI0nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTZWFyY2goKCkgPT4gZ2V0QnlTdHVkZW50TmFtZSh0aGlzLnNlYXJjaE5hbWUpKTsKICAgIH0sCiAgICBhc3luYyBzZWFyY2hCeVN0dWRlbnRObygpIHsKICAgICAgaWYgKCF0aGlzLnNlYXJjaFN0dWRlbnRObykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+36L6T5YWl5a2m55Sf5a2m5Y+3Jyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlU2VhcmNoKCgpID0+IGdldEJ5U3R1ZGVudE5vQW5kU3RhdHVzKHRoaXMuc2VhcmNoU3R1ZGVudE5vKSk7CiAgICB9LAogICAgLy8g6YCa55So5p+l6K+i5aSE55CGCiAgICBhc3luYyBoYW5kbGVTZWFyY2goYXBpQ2FsbCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaUNhbGwoKTsKICAgICAgICBpZiAoKHJlcyA9PT0gbnVsbCB8fCByZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlcy5zdGF0dXNDb2RlKSA9PT0gMjAwICYmIEFycmF5LmlzQXJyYXkocmVzLmRhdGEpKSB7CiAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9ucyA9IHJlcy5kYXRhOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKChyZXMgPT09IG51bGwgfHwgcmVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXMubXNnKSB8fCAn5p+l6K+i5aSx6LSlJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAn5p+l6K+i5aSx6LSlJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBzZWFyY2hBcHByb3ZlZCgpIHsKICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTZWFyY2goZ2V0QXBwcm92ZWRBcHBsaWNhdGlvbnMpOwogICAgfSwKICAgIGZvcm1hdERhdGUocm93LCBjb2x1bW4sIGNlbGxWYWx1ZSkgewogICAgICBpZiAoY2VsbFZhbHVlKSB7CiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGNlbGxWYWx1ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7CiAgICAgIH0KICAgICAgcmV0dXJuICcnOwogICAgfQogIH0KfTs="},{"version":3,"names":["getCounselorPendingApplications","approveByCounselor","getByClassName","getByStudentName","getByStudentNoAndStatus","getApprovedApplications","data","applications","loading","searchClass","searchName","searchStudentNo","created","fetchPendingApplications","methods","res","console","log","statusCode","Array","isArray","$message","error","msg","response","message","handleApprove","row","applyId","success","_error$response","searchByClass","warning","handleSearch","searchByName","searchByStudentNo","apiCall","searchApproved","formatDate","column","cellValue","Date","toLocaleDateString"],"sources":["src/views/manage/dayApplicationApproval/index.vue"],"sourcesContent":["<template>\r\n    <div class=\"app-container\">\r\n        <!-- 新增搜索表单 -->\r\n        <el-form :inline=\"true\" class=\"search-form\">\r\n            <el-form-item label=\"班级\">\r\n                <el-input v-model=\"searchClass\" placeholder=\"输入班级名称\" clearable/>\r\n            </el-form-item>\r\n            <el-form-item label=\"姓名\">\r\n                <el-input v-model=\"searchName\" placeholder=\"输入学生姓名\" clearable/>\r\n            </el-form-item>\r\n            <el-form-item label=\"学号\">\r\n                <el-input v-model=\"searchStudentNo\" placeholder=\"输入学生学号\" clearable/>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"searchByClass\">按班级查</el-button>\r\n                <el-button type=\"success\" @click=\"searchByName\">按姓名查</el-button>\r\n                <el-button type=\"warning\" @click=\"searchByStudentNo\">按学号查</el-button>\r\n                <el-button type=\"info\" @click=\"searchApproved\">显示已通过</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n\r\n        <el-table :data=\"applications\" v-loading=\"loading\">\r\n            <el-table-column prop=\"studentName\" label=\"学生姓名\" width=\"120\"></el-table-column>\r\n            <el-table-column prop=\"className\" label=\"班级\" width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"department\" label=\"院系\" width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"phone\" label=\"联系电话\" width=\"120\"></el-table-column>\r\n            <el-table-column prop=\"startDate\" label=\"开始日期\" width=\"120\" :formatter=\"formatDate\"></el-table-column>\r\n            <el-table-column prop=\"endDate\" label=\"结束日期\" width=\"120\" :formatter=\"formatDate\"></el-table-column>\r\n            <el-table-column prop=\"reason\" label=\"请假原因\" min-width=\"200\"></el-table-column>\r\n            <el-table-column prop=\"counselorStatus\" label=\"审批状态\" width=\"100\">\r\n                <template #default=\"scope\">\r\n                    <el-tag :type=\"scope.row.counselorStatus === '待审核' ? 'warning' : 'success'\">\r\n                        {{ scope.row.counselorStatus }}\r\n                    </el-tag>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"120\">\r\n                <template #default=\"scope\">\r\n                    <el-button type=\"primary\" size=\"small\" @click=\"handleApprove(scope.row)\">审批通过</el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n    getCounselorPendingApplications,\r\n    approveByCounselor,\r\n    getByClassName,\r\n    getByStudentName,\r\n    getByStudentNoAndStatus,\r\n    getApprovedApplications\r\n} from '@/api/leaveApplication'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            applications: [],\r\n            loading: false,\r\n            searchClass: '',\r\n            searchName: '',\r\n            searchStudentNo: ''\r\n        }\r\n    },\r\n    created() {\r\n        this.fetchPendingApplications()\r\n    },\r\n    methods: {\r\n        async fetchPendingApplications() {\r\n            this.loading = true\r\n            try {\r\n                const res = await getCounselorPendingApplications()\r\n                console.log('完整响应:', res)\r\n                \r\n                // 修改判断条件和数据路径\r\n                if (res?.statusCode === 200 && Array.isArray(res.data)) {\r\n                    this.applications = res.data\r\n                    console.log('处理后的数据:', this.applications)\r\n                } else {\r\n                    this.$message.error(res?.msg || '数据格式异常')  // 使用msg字段\r\n                }\r\n            } catch (error) {\r\n                console.error('请求异常:', error.response || error)\r\n                this.$message.error(error.message || '请求失败')\r\n            } finally {\r\n                this.loading = false\r\n            }\r\n        },\r\n        async handleApprove(row) {\r\n            try {\r\n                // 使用封装好的API方法\r\n                await approveByCounselor(row.applyId)\r\n                this.$message.success('审批成功')\r\n                // 刷新列表数据\r\n                await this.fetchPendingApplications()\r\n            } catch (error) {\r\n                console.error('审批失败:', error)\r\n                // 显示更详细的错误信息\r\n                this.$message.error(error.response?.data?.msg || '审批操作失败')\r\n            }\r\n        },\r\n                async searchByClass() {\r\n            if (!this.searchClass) {\r\n                this.$message.warning('请输入班级名称')\r\n                return\r\n            }\r\n            await this.handleSearch(() => getByClassName(this.searchClass))\r\n        },\r\n\r\n        async searchByName() {\r\n            if (!this.searchName) {\r\n                this.$message.warning('请输入学生姓名')\r\n                return\r\n            }\r\n            await this.handleSearch(() => getByStudentName(this.searchName))\r\n        },\r\n\r\n        async searchByStudentNo() {\r\n            if (!this.searchStudentNo) {\r\n                this.$message.warning('请输入学生学号')\r\n                return\r\n            }\r\n            await this.handleSearch(() => getByStudentNoAndStatus(this.searchStudentNo))\r\n        },\r\n                // 通用查询处理\r\n        async handleSearch(apiCall) {\r\n            this.loading = true\r\n            try {\r\n                const res = await apiCall()\r\n                if (res?.statusCode === 200 && Array.isArray(res.data)) {\r\n                    this.applications = res.data\r\n                } else {\r\n                    this.$message.error(res?.msg || '查询失败')\r\n                }\r\n            } catch (error) {\r\n                this.$message.error(error.message || '查询失败')\r\n            } finally {\r\n                this.loading = false\r\n            }\r\n        },\r\n    \r\n\r\n        async searchApproved() {\r\n            await this.handleSearch(getApprovedApplications)\r\n        },\r\n        formatDate(row, column, cellValue) {\r\n            if (cellValue) {\r\n                return new Date(cellValue).toLocaleDateString()\r\n            }\r\n            return ''\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.el-table {\r\n    margin-top: 20px;\r\n    min-height: 400px;\r\n}\r\n</style>"],"mappings":"AA8CA,SACAA,+BAAA,EACAC,kBAAA,EACAC,cAAA,EACAC,gBAAA,EACAC,uBAAA,EACAC,uBAAA,QACA;AAEA;EACAC,KAAA;IACA;MACAC,YAAA;MACAC,OAAA;MACAC,WAAA;MACAC,UAAA;MACAC,eAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,wBAAA;EACA;EACAC,OAAA;IACA,MAAAD,yBAAA;MACA,KAAAL,OAAA;MACA;QACA,MAAAO,GAAA,SAAAf,+BAAA;QACAgB,OAAA,CAAAC,GAAA,UAAAF,GAAA;;QAEA;QACA,KAAAA,GAAA,aAAAA,GAAA,uBAAAA,GAAA,CAAAG,UAAA,aAAAC,KAAA,CAAAC,OAAA,CAAAL,GAAA,CAAAT,IAAA;UACA,KAAAC,YAAA,GAAAQ,GAAA,CAAAT,IAAA;UACAU,OAAA,CAAAC,GAAA,iBAAAV,YAAA;QACA;UACA,KAAAc,QAAA,CAAAC,KAAA,EAAAP,GAAA,aAAAA,GAAA,uBAAAA,GAAA,CAAAQ,GAAA;QACA;MACA,SAAAD,KAAA;QACAN,OAAA,CAAAM,KAAA,UAAAA,KAAA,CAAAE,QAAA,IAAAF,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA,CAAAA,KAAA,CAAAG,OAAA;MACA;QACA,KAAAjB,OAAA;MACA;IACA;IACA,MAAAkB,cAAAC,GAAA;MACA;QACA;QACA,MAAA1B,kBAAA,CAAA0B,GAAA,CAAAC,OAAA;QACA,KAAAP,QAAA,CAAAQ,OAAA;QACA;QACA,WAAAhB,wBAAA;MACA,SAAAS,KAAA;QAAA,IAAAQ,eAAA;QACAd,OAAA,CAAAM,KAAA,UAAAA,KAAA;QACA;QACA,KAAAD,QAAA,CAAAC,KAAA,GAAAQ,eAAA,GAAAR,KAAA,CAAAE,QAAA,cAAAM,eAAA,gBAAAA,eAAA,GAAAA,eAAA,CAAAxB,IAAA,cAAAwB,eAAA,uBAAAA,eAAA,CAAAP,GAAA;MACA;IACA;IACA,MAAAQ,cAAA;MACA,UAAAtB,WAAA;QACA,KAAAY,QAAA,CAAAW,OAAA;QACA;MACA;MACA,WAAAC,YAAA,OAAA/B,cAAA,MAAAO,WAAA;IACA;IAEA,MAAAyB,aAAA;MACA,UAAAxB,UAAA;QACA,KAAAW,QAAA,CAAAW,OAAA;QACA;MACA;MACA,WAAAC,YAAA,OAAA9B,gBAAA,MAAAO,UAAA;IACA;IAEA,MAAAyB,kBAAA;MACA,UAAAxB,eAAA;QACA,KAAAU,QAAA,CAAAW,OAAA;QACA;MACA;MACA,WAAAC,YAAA,OAAA7B,uBAAA,MAAAO,eAAA;IACA;IACA;IACA,MAAAsB,aAAAG,OAAA;MACA,KAAA5B,OAAA;MACA;QACA,MAAAO,GAAA,SAAAqB,OAAA;QACA,KAAArB,GAAA,aAAAA,GAAA,uBAAAA,GAAA,CAAAG,UAAA,aAAAC,KAAA,CAAAC,OAAA,CAAAL,GAAA,CAAAT,IAAA;UACA,KAAAC,YAAA,GAAAQ,GAAA,CAAAT,IAAA;QACA;UACA,KAAAe,QAAA,CAAAC,KAAA,EAAAP,GAAA,aAAAA,GAAA,uBAAAA,GAAA,CAAAQ,GAAA;QACA;MACA,SAAAD,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA,CAAAA,KAAA,CAAAG,OAAA;MACA;QACA,KAAAjB,OAAA;MACA;IACA;IAGA,MAAA6B,eAAA;MACA,WAAAJ,YAAA,CAAA5B,uBAAA;IACA;IACAiC,WAAAX,GAAA,EAAAY,MAAA,EAAAC,SAAA;MACA,IAAAA,SAAA;QACA,WAAAC,IAAA,CAAAD,SAAA,EAAAE,kBAAA;MACA;MACA;IACA;EACA;AACA","ignoreList":[]}]}