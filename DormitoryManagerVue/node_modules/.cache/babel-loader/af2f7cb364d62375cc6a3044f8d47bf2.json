{"remainingRequest":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\thread-loader\\dist\\cjs.js!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\building\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\building\\index.vue","mtime":1698660728000},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\babel.config.js","mtime":1626253806000},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1762330398084},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1762330415881},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1762330415853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGxpc3QsIHF1ZXJ5LCBkZWwsIHNhdmVPclVwZGF0ZSB9IGZyb20gIkAvYXBpL2J1aWxkaW5nIjsKaW1wb3J0IFRyZWVTZWxlY3QgZnJvbSAnQHJpb3BoYWUvdnVlLXRyZWVzZWxlY3QnOwppbXBvcnQgIkByaW9waGFlL3Z1ZS10cmVlc2VsZWN0L2Rpc3QvdnVlLXRyZWVzZWxlY3QuY3NzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJpbmRleCIsCiAgY29tcG9uZW50czogewogICAgVHJlZVNlbGVjdAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IFtdLAogICAgICBidWlsZGluZzogewogICAgICAgIGlkOiB1bmRlZmluZWQsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IHVuZGVmaW5lZCwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiB7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICflkI3np7DkuI3og73kuLrnqbonLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfQogICAgICB9LAogICAgICBkZWZhdWx0RXhwYW5kOiBbXSwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGRpYWxvZ1RpdGxlOiAn5re75YqgJwogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG5vcm1hbGl6ZXIobm9kZSkgewogICAgICBpZiAobm9kZS5jaGlsZHJlbiAmJiAhbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICBkZWxldGUgbm9kZS5jaGlsZHJlbjsKICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGlkOiBub2RlLmlkLAogICAgICAgIGxhYmVsOiBub2RlLm5hbWUsCiAgICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4KICAgICAgfTsKICAgIH0sCiAgICBzYXZlT3JVcGRhdGUoKSB7CiAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgdGhpcy4kcmVmc1snc2F2ZU9yVXBkYXRlRm9ybSddLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHNhdmVPclVwZGF0ZSh0aGlzLmJ1aWxkaW5nKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMubXNnLAogICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlQ2xvc2UoKTsKICAgICAgICAgICAgICBfdGhpcy5saXN0RGF0YSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fmraPnoa7loavlhpnlj4LmlbAnLAogICAgICAgICAgICB0eXBlOiAnZXJyb3InCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHNob3dEaWFsb2coaWQpIHsKICAgICAgdGhpcy5kaWFsb2dUaXRsZSA9ICfmt7vliqDmpbwnOwogICAgICBpZiAoaWQpIHsKICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gJ+S/ruaUuealvCc7CiAgICAgICAgY29uc3QgewogICAgICAgICAgZGF0YQogICAgICAgIH0gPSBhd2FpdCBxdWVyeShpZCk7CiAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgIHRoaXMuYnVpbGRpbmcgPSBkYXRhOwogICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUNsb3NlKCkgewogICAgICB0aGlzLmJ1aWxkaW5nID0gewogICAgICAgIGlkOiB1bmRlZmluZWQsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkCiAgICAgIH07CiAgICAgIHRoaXMuJHJlZnNbJ3NhdmVPclVwZGF0ZUZvcm0nXS5yZXNldEZpZWxkcygpOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgIH0sCiAgICBkZWwoaWQpIHsKICAgICAgZGVsKGlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiByZXMubXNnLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5saXN0RGF0YSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbGlzdERhdGEoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGNvbnN0IHsKICAgICAgICBkYXRhCiAgICAgIH0gPSBhd2FpdCBsaXN0KCk7CiAgICAgIHRoaXMubGlzdCA9IGRhdGE7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICBmb3IgKGxldCBpIG9mIHRoaXMubGlzdCkgewogICAgICAgIHRoaXMuZGVmYXVsdEV4cGFuZC5wdXNoKGkuaWQudG9TdHJpbmcoKSk7CiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxpc3REYXRhKCk7CiAgfQp9Ow=="},{"version":3,"names":["list","query","del","saveOrUpdate","TreeSelect","name","components","data","building","id","undefined","loading","rules","required","message","trigger","defaultExpand","dialogVisible","dialogTitle","methods","normalizer","node","children","length","label","_this","$refs","validate","valid","then","res","statusCode","$message","msg","type","handleClose","listData","showDialog","resetFields","i","push","toString","created"],"sources":["src/views/manage/building/index.vue"],"sourcesContent":["<template>\n  <div class=\"router-container\">\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <div class=\"table\">\n          <el-form>\n            <el-form-item>\n              <el-button v-has-permi=\"['manage:building:save']\" @click=\"showDialog(undefined)\" type=\"primary\">\n                新增\n              </el-button>\n            </el-form-item>\n          </el-form>\n\n          <el-table :expand-row-keys=\"defaultExpand\" :data=\"list\" v-loading=\"loading\" :tree-props=\"{children: 'children'}\" row-key=\"id\">\n            <el-table-column label=\"名称\" prop=\"name\"></el-table-column>\n            <el-table-column label=\"宿舍数量\" prop=\"roomNum\"></el-table-column>\n            <el-table-column label=\"人数\" prop=\"studentNum\"></el-table-column>\n            <el-table-column label=\"操作\">\n              <template slot-scope=\"scope\">\n                <el-button v-has-permi=\"['manage:building:query']\"\n                            type=\"primary\" @click=\"showDialog(scope.row.id)\">详情\n                </el-button>\n                <template>\n                  <el-popconfirm title=\"确定删除吗？\" @confirm=\"del(scope.row.id)\">\n                    <el-button style=\"margin-left: 8px\" v-has-permi=\"['manage:building:delete']\"\n                               slot=\"reference\"\n                                type=\"danger\"> 删除\n                    </el-button>\n                  </el-popconfirm>\n                </template>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        <div class=\"dialog\">\n          <el-dialog\n              :title=\"dialogTitle\"\n              :visible.sync=\"dialogVisible\"\n              width=\"45%\"\n              @closed=\"handleClose\"\n          >\n            <el-form ref=\"saveOrUpdateForm\" :rules=\"rules\" :model=\"building\" label-width=\"80px\">\n              <el-form-item label=\"上级\">\n                <tree-select\n                    v-model=\"building.parentId\"\n                    :options=\"list\"\n                    :normalizer=\"normalizer\"\n                    :show-count=\"true\"\n                    placeholder=\"选择上级\">\n                </tree-select>\n              </el-form-item>\n              <el-form-item label=\"名称\" prop=\"name\">\n                <el-input v-model=\"building.name\" placeholder=\"输入名称\"></el-input>\n              </el-form-item>\n            </el-form>\n            <span slot=\"footer\" class=\"dialog-footer\">\n              <el-button type=\"danger\" @click=\"handleClose\"> 取 消</el-button>\n              <el-button type=\"primary\" v-has-permi=\"['manage:building:update']\" @click=\"saveOrUpdate\"> 保 存</el-button>\n            </span>\n          </el-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {list, query, del, saveOrUpdate} from \"@/api/building\";\nimport TreeSelect from '@riophae/vue-treeselect'\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\n\nexport default {\n  name: \"index\",\n  components:{TreeSelect},\n  data() {\n    return {\n      list:[],\n      building:{\n        id: undefined,\n        name: undefined\n      },\n      loading: undefined,\n      rules: {\n        name: {required: true, message: '名称不能为空', trigger: 'blur'}\n      },\n      defaultExpand: [],\n      dialogVisible:false,\n      dialogTitle: '添加'\n    }\n  },\n  methods: {\n    normalizer(node) {\n      if (node.children && !node.children.length) {\n        delete node.children;\n      }\n      return {\n        id: node.id,\n        label: node.name,\n        children: node.children\n      };\n    },\n    saveOrUpdate() {\n      const _this = this\n      this.$refs['saveOrUpdateForm'].validate((valid) => {\n        if (valid) {\n          saveOrUpdate(this.building).then(res => {\n            if (res.statusCode === 200) {\n              this.$message({\n                message: res.msg,\n                type: 'success'\n              });\n              _this.handleClose()\n              _this.listData()\n            }\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      })\n    },\n    async showDialog(id) {\n      this.dialogTitle = '添加楼'\n      if (id) {\n        this.dialogTitle = '修改楼'\n        const {data} = await query(id)\n        if (data) {\n          this.building = data\n          this.dialogVisible = true\n        }\n      } else {\n        this.dialogVisible = true\n      }\n    },\n    handleClose() {\n      this.building = {\n        id: undefined,\n        name: undefined\n      }\n      this.$refs['saveOrUpdateForm'].resetFields()\n      this.dialogVisible = false\n    },\n    del(id) {\n      del(id).then(res => {\n        if (res.statusCode === 200) {\n          this.$message({\n            message: res.msg,\n            type: 'success'\n          });\n          this.listData()\n        }\n      })\n    },\n    async listData() {\n      this.loading = true\n      const {data} = await list()\n      this.list = data\n      this.loading = false\n      for (let i of this.list) {\n        this.defaultExpand.push(i.id.toString())\n      }\n    }\n  },\n  created() {\n    this.listData()\n  }\n}\n</script>\n\n<style scoped>\n.table {\n  padding: 10px;\n}\n\n.router-container {\n  height: 100%;\n}\n</style>\n"],"mappings":";AAmEA,SAAAA,IAAA,EAAAC,KAAA,EAAAC,GAAA,EAAAC,YAAA;AACA,OAAAC,UAAA;AACA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAF;EAAA;EACAG,KAAA;IACA;MACAP,IAAA;MACAQ,QAAA;QACAC,EAAA,EAAAC,SAAA;QACAL,IAAA,EAAAK;MACA;MACAC,OAAA,EAAAD,SAAA;MACAE,KAAA;QACAP,IAAA;UAAAQ,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;MACAC,aAAA;MACAC,aAAA;MACAC,WAAA;IACA;EACA;EACAC,OAAA;IACAC,WAAAC,IAAA;MACA,IAAAA,IAAA,CAAAC,QAAA,KAAAD,IAAA,CAAAC,QAAA,CAAAC,MAAA;QACA,OAAAF,IAAA,CAAAC,QAAA;MACA;MACA;QACAb,EAAA,EAAAY,IAAA,CAAAZ,EAAA;QACAe,KAAA,EAAAH,IAAA,CAAAhB,IAAA;QACAiB,QAAA,EAAAD,IAAA,CAAAC;MACA;IACA;IACAnB,aAAA;MACA,MAAAsB,KAAA;MACA,KAAAC,KAAA,qBAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACAzB,YAAA,MAAAK,QAAA,EAAAqB,IAAA,CAAAC,GAAA;YACA,IAAAA,GAAA,CAAAC,UAAA;cACA,KAAAC,QAAA;gBACAlB,OAAA,EAAAgB,GAAA,CAAAG,GAAA;gBACAC,IAAA;cACA;cACAT,KAAA,CAAAU,WAAA;cACAV,KAAA,CAAAW,QAAA;YACA;UACA;QACA;UACA,KAAAJ,QAAA;YACAlB,OAAA;YACAoB,IAAA;UACA;UACA;QACA;MACA;IACA;IACA,MAAAG,WAAA5B,EAAA;MACA,KAAAS,WAAA;MACA,IAAAT,EAAA;QACA,KAAAS,WAAA;QACA;UAAAX;QAAA,UAAAN,KAAA,CAAAQ,EAAA;QACA,IAAAF,IAAA;UACA,KAAAC,QAAA,GAAAD,IAAA;UACA,KAAAU,aAAA;QACA;MACA;QACA,KAAAA,aAAA;MACA;IACA;IACAkB,YAAA;MACA,KAAA3B,QAAA;QACAC,EAAA,EAAAC,SAAA;QACAL,IAAA,EAAAK;MACA;MACA,KAAAgB,KAAA,qBAAAY,WAAA;MACA,KAAArB,aAAA;IACA;IACAf,IAAAO,EAAA;MACAP,GAAA,CAAAO,EAAA,EAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,UAAA;UACA,KAAAC,QAAA;YACAlB,OAAA,EAAAgB,GAAA,CAAAG,GAAA;YACAC,IAAA;UACA;UACA,KAAAE,QAAA;QACA;MACA;IACA;IACA,MAAAA,SAAA;MACA,KAAAzB,OAAA;MACA;QAAAJ;MAAA,UAAAP,IAAA;MACA,KAAAA,IAAA,GAAAO,IAAA;MACA,KAAAI,OAAA;MACA,SAAA4B,CAAA,SAAAvC,IAAA;QACA,KAAAgB,aAAA,CAAAwB,IAAA,CAAAD,CAAA,CAAA9B,EAAA,CAAAgC,QAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAN,QAAA;EACA;AACA","ignoreList":[]}]}