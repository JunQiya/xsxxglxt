{"remainingRequest":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\check\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\check\\index.vue","mtime":1744685972525},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\babel.config.js","mtime":1626253806000},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1762330415881},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1762330415853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCB7IGxpc3QgfSBmcm9tICJAL2FwaS9idWlsZGluZyI7CmltcG9ydCB7IGxpc3RSb29tc1dpdGhTY29yZXMsIHNjb3JlQnlSaWQgfSBmcm9tICJAL2FwaS9zY29yZSI7IC8vIOWBh+iuvuaWsOWinueahOaOpeWPo2xpc3RSb29tc1dpdGhTY29yZXMKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYnVpbGRpbmdNYXA6IG5ldyBNYXAoKSwKICAgICAgbGlzdFF1ZXJ5OiB7CiAgICAgICAgcGFnZTogMSwKICAgICAgICByb3dzOiAxMCwKICAgICAgICBidWlsZGluZ0lkOiBudWxsLAogICAgICAgIG51bWJlcjogJycKICAgICAgfSwKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgdG90YWw6IDAsCiAgICAgIC8vIOW8ueeql+ebuOWFs+aVsOaNrgogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgY3VycmVudFNjb3Jlczoge30sCiAgICAgIGN1cnJlbnRJbWFnZTogJycsCiAgICAgIHNjb3JlTGFiZWxzOiB7CiAgICAgICAgZ2xvYmFsX3Njb3JlOiB7CiAgICAgICAgICBsYWJlbDogJ+aVtOS9k+eOr+WigycKICAgICAgICB9LAogICAgICAgIGJ1aWxkaW5nX3Njb3JlOiB7CiAgICAgICAgICBsYWJlbDogJ+W7uuetkeiuvuaWvScKICAgICAgICB9LAogICAgICAgIGJlZF9zY29yZTogewogICAgICAgICAgbGFiZWw6ICfluorpk7rljaflhbcnCiAgICAgICAgfSwKICAgICAgICBpbmRvb3Jfc2NvcmU6IHsKICAgICAgICAgIGxhYmVsOiAn5a6k5YaF55So5ZOBJwogICAgICAgIH0sCiAgICAgICAgY2Vfc2NvcmU6IHsKICAgICAgICAgIGxhYmVsOiAn57u85ZCI6K+E5YiGJwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8g5qW85qCL6YCJ5oup55u45YWzCiAgICAgIGJkT3B0aW9uczogW10sCiAgICAgIHNlbGVjdGVkTm9kZTogW10KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgY3VycmVudFJvb20oKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTY29yZXMuYnVpbGRpbmcgJiYgdGhpcy5jdXJyZW50U2NvcmVzLnJvb20gPyBgJHt0aGlzLmN1cnJlbnRTY29yZXMuYnVpbGRpbmcubmFtZX0gLSAke3RoaXMuY3VycmVudFNjb3Jlcy5yb29tLm51bWJlcn1gIDogJ+Wuv+iIjeivpuaDhSc7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5blrr/oiI3liJfooajmlbDmja4KICAgIGFzeW5jIGZldGNoRGF0YSgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBsaXN0Um9vbXNXaXRoU2NvcmVzKHRoaXMubGlzdFF1ZXJ5LnBhZ2UsIHRoaXMubGlzdFF1ZXJ5LnJvd3MsIHRoaXMubGlzdFF1ZXJ5LmJ1aWxkaW5nSWQsIHRoaXMubGlzdFF1ZXJ5Lm51bWJlcik7CiAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuY29udGVudDsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzLnRvdGFsRWxlbWVudHM7CiAgICAgICAgY29uc29sZS5sb2codGhpcy50YWJsZURhdGEpOwoKICAgICAgICAvLyDlkIzmraXliIbpobXnirbmgIHvvIjpmLLmraLlkI7nq6/kv67mraPlj4LmlbDvvIkKICAgICAgICB0aGlzLmxpc3RRdWVyeS5wYWdlID0gcmVzLnBhZ2VOdW1iZXI7CiAgICAgICAgdGhpcy5saXN0UXVlcnkucm93cyA9IHJlcy5wYWdlU2l6ZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfmlbDmja7liqDovb3lpLHotKU6JywgZXJyb3IpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgfSwKICAgIC8vIOaYvuekuuivpuaDheW8ueeqlwogICAgYXN5bmMgc2hvd0RldGFpbChyb3cpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBzY29yZUJ5UmlkKHJvdy5yb29tX2lkKTsKICAgICAgICBjb25zdCBpbWdOYW1lID0gcmVzLmRhdGFbMF0uaW1nX25hbWU7CiAgICAgICAgdGhpcy4kc2V0KHJvdywgJ2ltZ19uYW1lJywgaW1nTmFtZSk7CiAgICAgICAgdGhpcy5jdXJyZW50U2NvcmVzID0gewogICAgICAgICAgLi4ucm93CiAgICAgICAgfTsKICAgICAgICB0aGlzLmN1cnJlbnRJbWFnZSA9IHByb2Nlc3MuZW52LlZVRV9BUFBfSU1HX1BSRUZJWCArIGltZ05hbWU7CiAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCLojrflj5blm77niYflpLHotKUiLCBlcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliIbpobXnm7jlhbPmlrnms5UKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5LnJvd3MgPSB2YWw7CiAgICAgIHRoaXMuZmV0Y2hEYXRhKCk7CiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucGFnZSA9IHZhbDsKICAgICAgdGhpcy5mZXRjaERhdGEoKTsKICAgIH0sCiAgICAvLyDmkJzntKLnm7jlhbMKICAgIGhhbmRsZVNlYXJjaCgpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucGFnZSA9IDE7CiAgICAgIHRoaXMuZmV0Y2hEYXRhKCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMubGlzdFF1ZXJ5LmJ1aWxkaW5nSWQpOwogICAgfSwKICAgIHJlc2V0UXVlcnkoKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5ID0gewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgcm93czogMTAsCiAgICAgICAgYnVpbGRpbmdJZDogbnVsbCwKICAgICAgICBudW1iZXI6ICcnCiAgICAgIH07CiAgICAgIHRoaXMuc2VsZWN0ZWROb2RlID0gW107CiAgICAgIHRoaXMuZmV0Y2hEYXRhKCk7CiAgICB9LAogICAgLy8g5qC85byP5YyW5pWw5o2uCiAgICAvLyBmb3JtYXREYXRhKGxpc3QpIHsKICAgIC8vICAgICByZXR1cm4gbGlzdC5tYXAoaXRlbSA9PiB7CiAgICAvLyAgICAgICAgIGNvbnN0IG5vZGUgPSB7CiAgICAvLyAgICAgICAgICAgICB2YWx1ZTogaXRlbS5pZCwKICAgIC8vICAgICAgICAgICAgIGxhYmVsOiBpdGVtLm51bWJlciB8fCBpdGVtLm5hbWUKICAgIC8vICAgICAgICAgfTsKICAgIC8vICAgICAgICAgLy8g5LuF5b2T5a2Y5Zyo5a2Q6IqC54K55LiU5Li65pWw57uE5pe277yM6YCS5b2S5qC85byP5YyW5a2Q6IqC54K5CiAgICAvLyAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0uY2hpbGRyZW4pICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgLy8gICAgICAgICAgICAgbm9kZS5jaGlsZHJlbiA9IHRoaXMuZm9ybWF0RGF0YShpdGVtLmNoaWxkcmVuKTsKICAgIC8vICAgICAgICAgfQoKICAgIC8vICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgZm9ybWF0RGF0YShsaXN0KSB7CiAgICAgIHJldHVybiBsaXN0Lm1hcChpdGVtID0+IHsKICAgICAgICB2YXIgX2l0ZW0kY2hpbGRyZW47CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHZhbHVlOiBpdGVtLmlkLAogICAgICAgICAgbGFiZWw6IGl0ZW0ubmFtZSwKICAgICAgICAgIGNoaWxkcmVuOiAoX2l0ZW0kY2hpbGRyZW4gPSBpdGVtLmNoaWxkcmVuKSAhPT0gbnVsbCAmJiBfaXRlbSRjaGlsZHJlbiAhPT0gdm9pZCAwICYmIF9pdGVtJGNoaWxkcmVuLmxlbmd0aCA/IHRoaXMuZm9ybWF0RGF0YShpdGVtLmNoaWxkcmVuKSA6IG51bGwKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmpbzmoIvpgInmi6nnm7jlhbPmlrnms5XvvIjkv53mjIHljp/mnInpgLvovpHvvIkKICAgIGFzeW5jIGJkQ2hhbmdlKHZhbHVlKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5LmJ1aWxkaW5nSWQgPSAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbHVlLmxlbmd0aCkgPiAwID8gdmFsdWVbdmFsdWUubGVuZ3RoIC0gMV0gOiBudWxsOwogICAgICB0aGlzLmhhbmRsZVNlYXJjaCgpOwogICAgfSwKICAgIGFzeW5jIGxpc3REYXRhKCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBjb25zdCB7CiAgICAgICAgZGF0YQogICAgICB9ID0gYXdhaXQgbGlzdCgpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLmZvcm1hdERhdGEoZGF0YSkpOwogICAgICB0aGlzLmJkT3B0aW9ucyA9IHRoaXMuZm9ybWF0RGF0YShkYXRhKTsKICAgICAgdGhpcy5idWlsZFBhdGhNYXAoZGF0YSk7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgfSwKICAgIGJ1aWxkUGF0aE1hcChub2RlcywgcGFyZW50UGF0aCA9ICcnKSB7CiAgICAgIG5vZGVzLmZvckVhY2gobm9kZSA9PiB7CiAgICAgICAgdmFyIF9ub2RlJGNoaWxkcmVuOwogICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoID0gcGFyZW50UGF0aCA/IGAke3BhcmVudFBhdGh9LyR7bm9kZS5uYW1lfWAgOiBub2RlLm5hbWU7CiAgICAgICAgdGhpcy5idWlsZGluZ01hcC5zZXQobm9kZS5pZCwgY3VycmVudFBhdGgpOwogICAgICAgIGlmICgoX25vZGUkY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuKSAhPT0gbnVsbCAmJiBfbm9kZSRjaGlsZHJlbiAhPT0gdm9pZCAwICYmIF9ub2RlJGNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5idWlsZFBhdGhNYXAobm9kZS5jaGlsZHJlbiwgY3VycmVudFBhdGgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgYXdhaXQgdGhpcy5saXN0RGF0YSgpOwogICAgYXdhaXQgdGhpcy5mZXRjaERhdGEoKTsKICB9Cn07"},{"version":3,"names":["list","listRoomsWithScores","scoreByRid","data","buildingMap","Map","listQuery","page","rows","buildingId","number","tableData","total","dialogVisible","currentScores","currentImage","scoreLabels","global_score","label","building_score","bed_score","indoor_score","ce_score","bdOptions","selectedNode","computed","currentRoom","building","room","name","methods","fetchData","loading","res","content","totalElements","console","log","pageNumber","pageSize","error","showDetail","row","room_id","imgName","img_name","$set","process","env","VUE_APP_IMG_PREFIX","handleSizeChange","val","handleCurrentChange","handleSearch","resetQuery","formatData","map","item","_item$children","value","id","children","length","bdChange","listData","buildPathMap","nodes","parentPath","forEach","node","_node$children","currentPath","set","created"],"sources":["src/views/manage/check/index.vue"],"sourcesContent":["<template>\r\n    <div class=\"router-container\">\r\n        <div class=\"container\">\r\n            <div class=\"inner_container\" v-loading=\"loading\">\r\n                <!-- 搜索筛选区域 -->\r\n                <el-form :inline=\"true\" ref=\"queryForm\" label-width=\"80px\">\r\n                    <el-form-item label=\"宿舍楼栋\">\r\n                        <!-- <el-cascader :options=\"bdOptions\" v-model=\"selectedNode\" @change=\"bdChange\"\r\n                            clearable></el-cascader> -->\r\n                        <el-cascader :options=\"bdOptions\" v-model=\"selectedNode\" @change=\"bdChange\"></el-cascader>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"宿舍号\">\r\n                        <!-- <el-input v-model=\"listQuery.number\" placeholder=\"输入宿舍号\" clearable></el-input> -->\r\n                        <el-input v-model=\"listQuery.number\" @keyup.enter=\"handleSearch\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\r\n                        <el-button @click=\"resetQuery\">重置</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n\r\n                <!-- 数据表格区域 -->\r\n                <el-table :data=\"tableData\" border height=\"700\">\r\n                    <el-table-column label=\"序号\" width=\"80\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{ (listQuery.page - 1) * listQuery.rows + scope.$index + 1 }}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <!-- <el-table-column prop=\"building.name\" label=\"所属宿舍楼\" show-overflow-tooltip></el-table-column> -->\r\n                    <el-table-column label=\"所属宿舍楼\" show-overflow-tooltip>\r\n                        <template slot-scope=\"{row}\">\r\n                            {{ buildingMap.get(row.building.id) || row.building.name }}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"room.number\" label=\"宿舍号\" width=\"120\"></el-table-column>\r\n                    <el-table-column prop=\"ce_score\" label=\"综合评分\" width=\"280\">\r\n                        <template slot-scope=\"{row}\">\r\n                            <el-rate v-model=\"row.ce_score\" :max=\"10\" disabled :allow-half=\"true\" />\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"rated_at\" label=\"检查时间\" width=\"180\"></el-table-column>\r\n                    <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-button type=\"text\" @click=\"showDetail(scope.row)\">详情</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n\r\n                <!-- 分页组件 -->\r\n                <el-pagination :current-page.sync=\"listQuery.page\" :page-sizes=\"[10, 20, 30]\"\r\n                    :page-size.sync=\"listQuery.rows\" :total=\"total\" @size-change=\"handleSizeChange\"\r\n                    @current-change=\"handleCurrentChange\" layout=\"total, sizes, prev, pager, next, jumper\">\r\n                </el-pagination>\r\n\r\n                <!-- 评分详情弹窗 -->\r\n                <el-dialog :title=\"currentRoom\" :visible.sync=\"dialogVisible\" width=\"60%\">\r\n                    <div class=\"dialog-content\">\r\n                        <div class=\"score-section\">\r\n                            <!-- 复用原有评分组件 -->\r\n                            <div class=\"rate-item\" v-for=\"(score, key) in scoreLabels\" :key=\"key\">\r\n                                <span>{{ score.label }}：</span>\r\n                                <el-rate v-model=\"currentScores[key]\" :max=\"10\" disabled :allow-half=\"true\" show-score\r\n                                    text-color=\"#ff9900\" score-template=\"{value}分\" />\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"image-section\">\r\n                            <h3>宿舍照片</h3>\r\n                            <img :src=\"currentImage\" alt=\"宿舍照片\" class=\"room-image\">\r\n                        </div>\r\n                    </div>\r\n                </el-dialog>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { list } from \"@/api/building\";\r\n    import { listRoomsWithScores, scoreByRid } from \"@/api/score\"; // 假设新增的接口listRoomsWithScores\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                buildingMap: new Map(),\r\n                listQuery: {\r\n                    page: 1,\r\n                    rows: 10,\r\n                    buildingId: null,\r\n                    number: ''\r\n                },\r\n                tableData: [],\r\n                total: 0,\r\n                // 弹窗相关数据\r\n                dialogVisible: false,\r\n                currentScores: {},\r\n                currentImage: '',\r\n                scoreLabels: {\r\n                    global_score: { label: '整体环境' },\r\n                    building_score: { label: '建筑设施' },\r\n                    bed_score: { label: '床铺卧具' },\r\n                    indoor_score: { label: '室内用品' },\r\n                    ce_score: { label: '综合评分' }\r\n                },\r\n                // 楼栋选择相关\r\n                bdOptions: [],\r\n                selectedNode: []\r\n            }\r\n        },\r\n        computed: {\r\n            currentRoom() {\r\n                return this.currentScores.building && this.currentScores.room\r\n                    ? `${this.currentScores.building.name} - ${this.currentScores.room.number}`\r\n                    : '宿舍详情';\r\n            }\r\n        },\r\n        methods: {\r\n            // 获取宿舍列表数据\r\n            async fetchData() {\r\n                this.loading = true;\r\n                try {\r\n                    const res = await listRoomsWithScores(\r\n                        this.listQuery.page,\r\n                        this.listQuery.rows,\r\n                        this.listQuery.buildingId,\r\n                        this.listQuery.number\r\n                    );\r\n\r\n                    this.tableData = res.content;\r\n                    this.total = res.totalElements;\r\n\r\n                    console.log(this.tableData)\r\n\r\n                    // 同步分页状态（防止后端修正参数）\r\n                    this.listQuery.page = res.pageNumber;\r\n                    this.listQuery.rows = res.pageSize;\r\n                } catch (error) {\r\n                    console.error('数据加载失败:', error);\r\n                } finally {\r\n                    this.loading = false;\r\n                }\r\n                this.loading = false\r\n            },\r\n            // 显示详情弹窗\r\n            async showDetail(row) {\r\n\r\n                try {\r\n                    const res = await scoreByRid(row.room_id);\r\n                    const imgName = res.data[0].img_name;\r\n                    this.$set(row, 'img_name', imgName);\r\n\r\n                    this.currentScores = { ...row };\r\n                    this.currentImage = process.env.VUE_APP_IMG_PREFIX + imgName;\r\n                    this.dialogVisible = true;\r\n                } catch (error) {\r\n                    console.error(\"获取图片失败\",error)\r\n                }\r\n            },\r\n\r\n            // 分页相关方法\r\n            handleSizeChange(val) {\r\n                this.listQuery.rows = val;\r\n                this.fetchData();\r\n            },\r\n            handleCurrentChange(val) {\r\n                this.listQuery.page = val;\r\n                this.fetchData();\r\n            },\r\n            // 搜索相关\r\n            handleSearch() {\r\n                this.listQuery.page = 1;\r\n                this.fetchData();\r\n                console.log(this.listQuery.buildingId)\r\n            },\r\n            resetQuery() {\r\n                this.listQuery = {\r\n                    page: 1,\r\n                    rows: 10,\r\n                    buildingId: null,\r\n                    number: ''\r\n                };\r\n                this.selectedNode = [];\r\n                this.fetchData();\r\n            },\r\n            // 格式化数据\r\n            // formatData(list) {\r\n            //     return list.map(item => {\r\n            //         const node = {\r\n            //             value: item.id,\r\n            //             label: item.number || item.name\r\n            //         };\r\n            //         // 仅当存在子节点且为数组时，递归格式化子节点\r\n            //         if (Array.isArray(item.children) && item.children.length > 0) {\r\n            //             node.children = this.formatData(item.children);\r\n            //         }\r\n\r\n            //         return node;\r\n            //     });\r\n            // },\r\n            formatData(list) {\r\n                return list.map(item => ({\r\n                    value: item.id,\r\n                    label: item.name,\r\n                    children: item.children?.length ? this.formatData(item.children) : null\r\n                }))\r\n            },\r\n            // 楼栋选择相关方法（保持原有逻辑）\r\n            async bdChange(value) {\r\n                this.listQuery.buildingId = value?.length > 0 ? value[value.length - 1] : null\r\n                this.handleSearch()\r\n            },\r\n            async listData() {\r\n                this.loading = true\r\n                const { data } = await list()\r\n                console.log(this.formatData(data))\r\n                this.bdOptions = this.formatData(data)\r\n                this.buildPathMap(data)\r\n                this.loading = false\r\n            },\r\n            buildPathMap(nodes, parentPath = '') {\r\n                nodes.forEach(node => {\r\n                    const currentPath = parentPath ? `${parentPath}/${node.name}` : node.name\r\n                    this.buildingMap.set(node.id, currentPath)\r\n                    if (node.children?.length) {\r\n                        this.buildPathMap(node.children, currentPath)\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        async created() {\r\n            await this.listData();\r\n            await this.fetchData();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .dialog-content {\r\n        display: flex;\r\n        gap: 30px;\r\n    }\r\n\r\n    .score-section {\r\n        flex: 1;\r\n    }\r\n\r\n    .image-section {\r\n        flex: 1;\r\n    }\r\n\r\n    .room-image {\r\n        width: 100%;\r\n        max-height: 300px;\r\n        object-fit: contain;\r\n        border-radius: 4px;\r\n    }\r\n\r\n    .rate-item {\r\n        margin: 15px 0;\r\n        font-size: 16px;\r\n    }\r\n</style>"],"mappings":"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","ignoreList":[]}]}