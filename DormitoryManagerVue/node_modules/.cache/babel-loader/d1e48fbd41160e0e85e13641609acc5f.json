{"remainingRequest":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\thread-loader\\dist\\cjs.js!G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js!G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\src\\views\\personal\\info\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\src\\views\\personal\\info\\index.vue","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\babel.config.js","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1712740387000},{"path":"G:\\E\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1712740387000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgeyBnZXRVc2VySW5mbywgdXBkYXRlLCBjaGFuZ2VJY29uIH0gZnJvbSAiQC9hcGkvdXNlciI7CmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAiQC91dGlscy9hdXRoIjsKaW1wb3J0IHN0b3JlIGZyb20gIkAvc3RvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBkYXRhKCkgewogICAgbGV0IHZhbGlkYXRvcjEgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDApIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsZXQgcmVnID0gL14xWzM0NTY3ODldXGR7OX0kLzsKICAgICAgaWYgKCFyZWcudGVzdCh2YWx1ZSkpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICAgIGxldCB2YWxpZGF0b3IyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IHJlZyA9IC9eWzAtOWEtekEtWl8uLV0rW0BdWzAtOWEtekEtWl8uLV0rKFsuXVthLXpBLVpdKyl7MSwyfSQvOwogICAgICBpZiAoIXJlZy50ZXN0KHZhbHVlKSkgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgaGVhZGVyOiB7CiAgICAgICAgIl91dCI6IGdldFRva2VuKCkKICAgICAgfSwKICAgICAgYWN0aW9uOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJICsgIi9wZXJtaXNzaW9uL3VwbG9hZCIsCiAgICAgIHVzZXI6IHsKICAgICAgICBpZDogdW5kZWZpbmVkLAogICAgICAgIHJlYWxOYW1lOiAnJywKICAgICAgICBpY29uOiB1bmRlZmluZWQsCiAgICAgICAgY2VsbHBob25lOiAnJywKICAgICAgICBlbWFpbDogJycKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICByZWFsTmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+WQjeensOS4jeiDveS4uuepuicsCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICAgIH0sIHsKICAgICAgICAgIG1pbjogMiwKICAgICAgICAgIG1heDogMjAsCiAgICAgICAgICBtZXNzYWdlOiAn6ZW/5bqm5ZyoIDIg5YiwIDIwIOS4quWtl+espicsCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICAgIH1dLAogICAgICAgIGNlbGxwaG9uZTogW3sKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdG9yMSwKICAgICAgICAgIG1lc3NhZ2U6ICLor7fovpPlhaXmraPnoa7nmoTmiYvmnLrlj7ciLAogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgICB9XSwKICAgICAgICBlbWFpbDogW3sKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdG9yMiwKICAgICAgICAgIG1lc3NhZ2U6ICLor7fovpPlhaXmraPnoa7nmoTpgq7nrrEiLAogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgaGFuZGxlQXZhdGFyU3VjY2VzcyhyZXMpIHsKICAgICAgYXdhaXQgdGhpcy5jaGFuZ2VJY29uKHJlcy5kYXRhKTsKICAgIH0sCiAgICBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgewogICAgICBjb25zdCBpc0pQRyA9IGZpbGUudHlwZS5pbmRleE9mKCdpbWFnZS8nKSAhPT0gLTE7CiAgICAgIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsKICAgICAgaWYgKCFpc0pQRykgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WPquiDveS4iuS8oOWbvueJhycpOwogICAgICB9CiAgICAgIGlmICghaXNMdDJNKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5aS05YOP5Zu+54mH5aSn5bCP5LiN6IO96LaF6L+HIDJNQiEnKTsKICAgICAgfQogICAgICByZXR1cm4gaXNKUEcgJiYgaXNMdDJNOwogICAgfSwKICAgIGFzeW5jIGNoYW5nZUljb24oaWNvbikgewogICAgICBjaGFuZ2VJY29uKGljb24pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB1cGRhdGUoZm9ybSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1dLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHVwZGF0ZSh0aGlzLnVzZXIpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgc3RvcmUuY29tbWl0KCdTRVRfVVNFUl9OQU1FJywgcmVzLmRhdGEucmVhbE5hbWUpOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICBtZXNzYWdlOiByZXMubXNnLAogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+ato+ehruWhq+WGmeWPguaVsCcsCiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgcmVzZXQoKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkYXRhCiAgICAgIH0gPSBhd2FpdCBnZXRVc2VySW5mbygpOwogICAgICBpZiAoZGF0YS5pY29uKSB7CiAgICAgICAgZGF0YS5pY29uID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9JTUdfUFJFRklYICsgZGF0YS5pY29uOwogICAgICB9CiAgICAgIHRoaXMudXNlciA9IGRhdGE7CiAgICAgIHN0b3JlLmNvbW1pdCgnU0VUX1VTRVJfSUNPTicsIHRoaXMudXNlci5pY29uKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnJlc2V0KCk7CiAgfQp9Ow=="},{"version":3,"names":["getUserInfo","update","changeIcon","getToken","store","name","data","validator1","rule","value","callback","length","reg","test","Error","validator2","header","action","process","env","VUE_APP_BASE_API","user","id","undefined","realName","icon","cellphone","email","rules","required","message","trigger","min","max","validator","methods","handleAvatarSuccess","res","beforeAvatarUpload","file","isJPG","type","indexOf","isLt2M","size","$message","error","then","statusCode","msg","reset","form","$refs","validate","valid","commit","VUE_APP_IMG_PREFIX","created"],"sources":["src/views/personal/info/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <div class=\"user-form\">\n          <div class=\"avatar\" title=\"点击更换头像\">\n            <el-upload\n                class=\"avatar-uploader\"\n                :action=\"action\"\n                :show-file-list=\"false\"\n                :headers=\"header\"\n                :on-success=\"handleAvatarSuccess\"\n                :before-upload=\"beforeAvatarUpload\">\n              <img v-if=\"user.icon\" :src=\"user.icon\" class=\"avatar\" alt=\"\">\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload>\n          </div>\n          <br>\n          <el-form ref=\"form\" :rules=\"rules\" :model=\"user\" label-width=\"100px\">\n            <el-form-item label=\"用户名称:\" prop=\"realName\">\n              <el-input v-model=\"user.realName\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"电话:\" prop=\"cellphone\">\n              <el-input v-model=\"user.cellphone\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"邮箱:\" prop=\"email\">\n              <el-input v-model=\"user.email\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"success\" style=\"font-size: 16px;\"  @click=\"update('form')\"> 修改</el-button>\n              <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"reset\"> 重置</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {getUserInfo, update, changeIcon} from \"@/api/user\";\nimport {getToken} from \"@/utils/auth\";\nimport store from \"@/store\";\n\nexport default {\n  name: \"index\",\n  data() {\n    let validator1 = (rule, value, callback) => {\n      if (value.length === 0) {\n        callback()\n        return\n      }\n      let reg = /^1[3456789]\\d{9}$/\n      if (!reg.test(value)) {\n        callback(new Error())\n      } else {\n        callback()\n      }\n    }\n    let validator2 = (rule, value, callback) => {\n      if (value.length === 0) {\n        callback()\n        return\n      }\n      let reg = /^[0-9a-zA-Z_.-]+[@][0-9a-zA-Z_.-]+([.][a-zA-Z]+){1,2}$/;\n      if (!reg.test(value)) {\n        callback(new Error())\n      } else {\n        callback()\n      }\n    }\n    return {\n      header: {\n        \"_ut\": getToken()\n      },\n      action: process.env.VUE_APP_BASE_API + \"/permission/upload\",\n      user: {\n        id: undefined,\n        realName: '',\n        icon: undefined,\n        cellphone: '',\n        email: ''\n      },\n      rules: {\n        realName: [\n          {required: true, message: '名称不能为空', trigger: 'change'},\n          {min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'change'}\n        ],\n        cellphone: [\n          {validator: validator1, message: \"请输入正确的手机号\", trigger: 'change'}\n        ],\n        email: [\n          {validator: validator2, message: \"请输入正确的邮箱\", trigger: 'change'}\n        ]\n      }\n    }\n  },\n  methods: {\n    async handleAvatarSuccess(res) {\n      await this.changeIcon(res.data)\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type.indexOf('image/') !== -1;\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('只能上传图片');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    async changeIcon(icon) {\n      changeIcon(icon).then(res => {\n        if (res.statusCode === 200) {\n          this.$message({\n            message: res.msg,\n            type: 'success'\n          });\n          this.reset()\n        }\n      })\n    },\n    update(form) {\n      this.$refs[form].validate((valid) => {\n        if (valid) {\n          update(this.user).then(res => {\n            store.commit('SET_USER_NAME', res.data.realName)\n            this.$message({\n              message: res.msg,\n              type: 'success'\n            });\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      });\n    },\n    async reset() {\n      const {data} = await getUserInfo()\n      if (data.icon) {\n        data.icon = process.env.VUE_APP_IMG_PREFIX + data.icon\n      }\n      this.user = data\n      store.commit('SET_USER_ICON', this.user.icon)\n    }\n  },\n  created() {\n    this.reset()\n  }\n}\n</script>\n\n<style scoped>\n.user-form {\n  width: 400px;\n  margin: 0 auto;\n}\n\n.avatar, .avatar-uploader {\n  width: 80px;\n  height: 80px;\n  margin: 0 auto;\n}\n\n.avatar-uploader i {\n  line-height: 80px;\n  text-align: center;\n  margin: 0 32px;\n}\n\n.avatar-uploader {\n  border: 1px dashed #d9d9d9;\n}\n\n.avatar-uploader:hover {\n  border-color: #409EFF;\n}\n</style>\n"],"mappings":"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","ignoreList":[]}]}