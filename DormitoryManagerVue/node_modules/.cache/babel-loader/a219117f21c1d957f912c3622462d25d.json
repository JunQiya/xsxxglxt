{"remainingRequest":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\check\\index copy.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\src\\views\\manage\\check\\index copy.vue","mtime":1743647230063},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\babel.config.js","mtime":1626253806000},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1762330415881},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\E\\学生宿舍信息管理系统\\xsxxpt\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1762330415853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCB7IGxpc3QgfSBmcm9tICJAL2FwaS9idWlsZGluZyI7CmltcG9ydCB7IGxpc3RCeUJJZCwgc2F2ZU9yVXBkYXRlLCBzY29yZUJ5UmlkIH0gZnJvbSAiQC9hcGkvc2NvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogdW5kZWZpbmVkLAogICAgICAvLyDlrr/oiI3liJfooagKICAgICAgcm9vbU9wdGlvbnM6IFtdLAogICAgICByb29tVmFsdWU6ICcnLAogICAgICAvLyDkuInnuqfoj5zljZXliJfooagKICAgICAgc2VsZWN0ZWR0Tm9kZTogW10sCiAgICAgIGJkT3B0aW9uczogW10sCiAgICAgIHNjb3JlOiB7CiAgICAgICAgZ2xvYmFsX3Njb3JlOiAwLAogICAgICAgIGJ1aWxkaW5nX3Njb3JlOiAwLAogICAgICAgIGJlZF9zY29yZTogMCwKICAgICAgICBpbmRvb3Jfc2NvcmU6IDAsCiAgICAgICAgY2Vfc2NvcmU6IDAKICAgICAgfSwKICAgICAgaW1nTmFtZTogJycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBoYW5kbGVDaGFuZ2UodmFsdWUpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsgLy8g5byA5ZCv5Yqg6L2954q25oCBCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzY29yZUJ5UmlkKHZhbHVlKTsgLy8g5byC5q2l6I635Y+W5pWw5o2uCgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlICE9PSAyMDApIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcign6K+35rGC5aSx6LSlLGNvZGU6JHtyZXNwb25zZS5zdGF0dXNDb2RlfScpOwogICAgICAgIH0KICAgICAgICBjb25zdCB7CiAgICAgICAgICBkYXRhCiAgICAgICAgfSA9IHJlc3BvbnNlOwogICAgICAgIC8vIOino+aehOi1i+WAvAogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGlkLAogICAgICAgICAgcm9vbV9pZCwKICAgICAgICAgIGdsb2JhbF9zY29yZSwKICAgICAgICAgIGJ1aWxkaW5nX3Njb3JlLAogICAgICAgICAgYmVkX3Njb3JlLAogICAgICAgICAgaW5kb29yX3Njb3JlLAogICAgICAgICAgY2Vfc2NvcmUsCiAgICAgICAgICBpbWdfbmFtZQogICAgICAgIH0gPSBkYXRhWzBdOwoKICAgICAgICAvLyDlhbbku5blrZfmrrXotYvlgLwKICAgICAgICB0aGlzLnNjb3JlLmdsb2JhbF9zY29yZSA9IGdsb2JhbF9zY29yZTsKICAgICAgICB0aGlzLnNjb3JlLmJ1aWxkaW5nX3Njb3JlID0gYnVpbGRpbmdfc2NvcmU7CiAgICAgICAgdGhpcy5zY29yZS5iZWRfc2NvcmUgPSBiZWRfc2NvcmU7CiAgICAgICAgdGhpcy5zY29yZS5pbmRvb3Jfc2NvcmUgPSBpbmRvb3Jfc2NvcmU7CiAgICAgICAgdGhpcy5zY29yZS5jZV9zY29yZSA9IGNlX3Njb3JlOwogICAgICAgIHRoaXMuaW1nTmFtZSA9IHByb2Nlc3MuZW52LlZVRV9BUFBfSU1HX1BSRUZJWCArIGltZ19uYW1lOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuaVsOiOt+WPluWksei0pTonLCBlcnJvcik7IC8vIOmUmeivr+WkhOeQhgogICAgICAgIHRoaXMuc2NvcmUgPSB7CiAgICAgICAgICBnbG9iYWxfc2NvcmU6IDAsCiAgICAgICAgICBidWlsZGluZ19zY29yZTogMCwKICAgICAgICAgIGJlZF9zY29yZTogMCwKICAgICAgICAgIGluZG9vcl9zY29yZTogMAogICAgICAgIH07CiAgICAgICAgdGhpcy5pbWdOYW1lID0gJyc7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7IC8vIOaXoOiuuuaIkOWKn+S4juWQpumDveWFs+mXreWKoOi9veeKtuaAgQogICAgICB9CiAgICB9LAogICAgYXN5bmMgYmRDaGFuZ2UodmFsdWUpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgY29uc3QgewogICAgICAgIGRhdGEKICAgICAgfSA9IGF3YWl0IGxpc3RCeUJJZCh2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXSk7CiAgICAgIHRoaXMucm9vbU9wdGlvbnMgPSB0aGlzLmZvcm1hdERhdGEoZGF0YSk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMucm9vbU9wdGlvbnMpOwogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgIH0sCiAgICAvLyDmoLzlvI/ljJbmlbDmja4KICAgIGZvcm1hdERhdGEobGlzdCkgewogICAgICByZXR1cm4gbGlzdC5tYXAoaXRlbSA9PiB7CiAgICAgICAgY29uc3Qgbm9kZSA9IHsKICAgICAgICAgIHZhbHVlOiBpdGVtLmlkLAogICAgICAgICAgbGFiZWw6IGl0ZW0ubnVtYmVyIHx8IGl0ZW0ubmFtZQogICAgICAgIH07CiAgICAgICAgLy8g5LuF5b2T5a2Y5Zyo5a2Q6IqC54K55LiU5Li65pWw57uE5pe277yM6YCS5b2S5qC85byP5YyW5a2Q6IqC54K5CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbS5jaGlsZHJlbikgJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICBub2RlLmNoaWxkcmVuID0gdGhpcy5mb3JtYXREYXRhKGl0ZW0uY2hpbGRyZW4pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbGlzdERhdGEoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGNvbnN0IHsKICAgICAgICBkYXRhCiAgICAgIH0gPSBhd2FpdCBsaXN0KCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybWF0RGF0YShkYXRhKSk7CiAgICAgIHRoaXMuYmRPcHRpb25zID0gdGhpcy5mb3JtYXREYXRhKGRhdGEpOwogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxpc3REYXRhKCk7CiAgfQp9Ow=="},{"version":3,"names":["list","listByBId","saveOrUpdate","scoreByRid","name","data","loading","undefined","roomOptions","roomValue","selectedtNode","bdOptions","score","global_score","building_score","bed_score","indoor_score","ce_score","imgName","methods","handleChange","value","response","statusCode","Error","id","room_id","img_name","process","env","VUE_APP_IMG_PREFIX","error","console","bdChange","length","formatData","log","map","item","node","label","number","Array","isArray","children","listData","created"],"sources":["src/views/manage/check/index copy.vue"],"sourcesContent":["<template>\r\n    <div class=\"router-container\">\r\n        <div class=\"container\">\r\n            <div class=\"inner_container\" v-loading=\"loading\">\r\n                <div class=\"table\">\r\n                    <div class=\"room_selector\">\r\n                        <div class=\"select_item\">\r\n                            <span>选择楼栋：</span>\r\n                            <el-cascader :options=\"bdOptions\" v-model=\"selectedtNode\" @change=\"bdChange\"></el-cascader>\r\n                        </div>\r\n                        <div class=\"select_item\">\r\n                            <span>选择宿舍：</span>\r\n                            <el-select v-model=\"roomValue\" clearable @change=\"handleChange\">\r\n                                <el-option v-for=\"item in roomOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"table_rate\">\r\n                    <!-- 上方两行 -->\r\n                    <div class=\"rate-item\">\r\n                        <span>整体环境评分：</span>\r\n                        <el-rate v-model=\"score.global_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>建筑设施评分：</span>\r\n                        <el-rate v-model=\"score.building_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <!-- 下方两行 -->\r\n                    <div class=\"rate-item\">\r\n                        <span>床铺卧具评分：</span>\r\n                        <el-rate v-model=\"score.bed_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>室内用品评分：</span>\r\n                        <el-rate v-model=\"score.indoor_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>综合宿舍评分：</span>\r\n                        <el-rate v-model=\"score.ce_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                </div>\r\n                <div class=\"img_box\">\r\n                    <h1>宿舍照片</h1>\r\n                    <img :src=\"imgName\" alt=\"暂未照片\">\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { list } from \"@/api/building\";\r\n    import { listByBId, saveOrUpdate, scoreByRid } from \"@/api/score\"\r\n\r\n    export default {\r\n        name: \"index\",\r\n        data() {\r\n            return {\r\n                loading: undefined,\r\n                // 宿舍列表\r\n                roomOptions: [],\r\n                roomValue: '',\r\n                // 三级菜单列表\r\n                selectedtNode: [],\r\n                bdOptions: [],\r\n                score: { global_score: 0, building_score: 0, bed_score: 0, indoor_score: 0, ce_score: 0 },\r\n                imgName: ''\r\n            }\r\n        },\r\n        methods: {\r\n            async handleChange(value) {\r\n                this.loading = true; // 开启加载状态\r\n                try {\r\n                    const response = await scoreByRid(value)// 异步获取数据\r\n\r\n                    if (response.statusCode !== 200) {\r\n                        throw new Error('请求失败,code:${response.statusCode}')\r\n                    }\r\n\r\n                    const { data } = response\r\n                    // 解构赋值\r\n                    const {\r\n                        id,\r\n                        room_id,\r\n                        global_score,\r\n                        building_score,\r\n                        bed_score,\r\n                        indoor_score,\r\n                        ce_score,\r\n                        img_name\r\n                    } = data[0];\r\n\r\n                    // 其他字段赋值\r\n                    this.score.global_score = global_score;\r\n                    this.score.building_score = building_score;\r\n                    this.score.bed_score = bed_score;\r\n                    this.score.indoor_score = indoor_score;\r\n                    this.score.ce_score = ce_score;\r\n                    this.imgName = process.env.VUE_APP_IMG_PREFIX + img_name;\r\n                } catch (error) {\r\n                    console.error('分数获取失败:', error); // 错误处理\r\n                    this.score = {\r\n                        global_score: 0,\r\n                        building_score: 0,\r\n                        bed_score: 0,\r\n                        indoor_score: 0,\r\n                    }\r\n                    this.imgName = ''\r\n                } finally {\r\n                    this.loading = false; // 无论成功与否都关闭加载状态\r\n                }\r\n            }\r\n            ,\r\n            async bdChange(value) {\r\n                this.loading = true\r\n                const { data } = await listByBId(value[value.length - 1])\r\n                this.roomOptions = this.formatData(data)\r\n                console.log(this.roomOptions)\r\n                this.loading = false\r\n            },\r\n            // 格式化数据\r\n            formatData(list) {\r\n                return list.map(item => {\r\n                    const node = {\r\n                        value: item.id,\r\n                        label: item.number || item.name\r\n                    };\r\n                    // 仅当存在子节点且为数组时，递归格式化子节点\r\n                    if (Array.isArray(item.children) && item.children.length > 0) {\r\n                        node.children = this.formatData(item.children);\r\n                    }\r\n\r\n                    return node;\r\n                });\r\n            },\r\n            async listData() {\r\n                this.loading = true\r\n                const { data } = await list()\r\n                console.log(this.formatData(data))\r\n                this.bdOptions = this.formatData(data)\r\n                this.loading = false\r\n            },\r\n        },\r\n        created() {\r\n            this.listData()\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .table {\r\n        padding: 10px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        flex: 1.5;\r\n    }\r\n\r\n    .router-container {\r\n        height: 100%;\r\n    }\r\n\r\n    .inner_container {\r\n        display: flex;\r\n    }\r\n\r\n    .room_selector {\r\n        display: flex;\r\n        margin-bottom: 5vh;\r\n    }\r\n\r\n    .select_item {\r\n        margin-right: 2.5vw;\r\n        margin-bottom: 2.5vh;\r\n    }\r\n\r\n    .rate-item {\r\n        display: flex;\r\n        margin-bottom: 5vh;\r\n        margin-left: 1vw;\r\n        font-size: 20px;\r\n        color: rgb(148, 148, 148);\r\n    }\r\n\r\n    .img_box {\r\n        flex: 2;\r\n        height: 70vh;\r\n        min-width: 300px;\r\n    }\r\n\r\n    .img_box h1 {\r\n        margin-bottom: 2vh;\r\n    }\r\n\r\n    .img_box img {\r\n        width: 100%;\r\n        height: 80%;\r\n        object-fit: contain;\r\n    }\r\n\r\n    ::v-deep .el-rate__icon {\r\n        font-size: 2rem !important;\r\n        /* 调整星星大小 */\r\n        margin-right: 5px;\r\n        /* 调整星星间距 */\r\n    }\r\n</style>"],"mappings":";;;AA6DA,SAAAA,IAAA;AACA,SAAAC,SAAA,EAAAC,YAAA,EAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA,EAAAC,SAAA;MACA;MACAC,WAAA;MACAC,SAAA;MACA;MACAC,aAAA;MACAC,SAAA;MACAC,KAAA;QAAAC,YAAA;QAAAC,cAAA;QAAAC,SAAA;QAAAC,YAAA;QAAAC,QAAA;MAAA;MACAC,OAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,aAAAC,KAAA;MACA,KAAAf,OAAA;MACA;QACA,MAAAgB,QAAA,SAAAnB,UAAA,CAAAkB,KAAA;;QAEA,IAAAC,QAAA,CAAAC,UAAA;UACA,UAAAC,KAAA;QACA;QAEA;UAAAnB;QAAA,IAAAiB,QAAA;QACA;QACA;UACAG,EAAA;UACAC,OAAA;UACAb,YAAA;UACAC,cAAA;UACAC,SAAA;UACAC,YAAA;UACAC,QAAA;UACAU;QACA,IAAAtB,IAAA;;QAEA;QACA,KAAAO,KAAA,CAAAC,YAAA,GAAAA,YAAA;QACA,KAAAD,KAAA,CAAAE,cAAA,GAAAA,cAAA;QACA,KAAAF,KAAA,CAAAG,SAAA,GAAAA,SAAA;QACA,KAAAH,KAAA,CAAAI,YAAA,GAAAA,YAAA;QACA,KAAAJ,KAAA,CAAAK,QAAA,GAAAA,QAAA;QACA,KAAAC,OAAA,GAAAU,OAAA,CAAAC,GAAA,CAAAC,kBAAA,GAAAH,QAAA;MACA,SAAAI,KAAA;QACAC,OAAA,CAAAD,KAAA,YAAAA,KAAA;QACA,KAAAnB,KAAA;UACAC,YAAA;UACAC,cAAA;UACAC,SAAA;UACAC,YAAA;QACA;QACA,KAAAE,OAAA;MACA;QACA,KAAAZ,OAAA;MACA;IACA;IAEA,MAAA2B,SAAAZ,KAAA;MACA,KAAAf,OAAA;MACA;QAAAD;MAAA,UAAAJ,SAAA,CAAAoB,KAAA,CAAAA,KAAA,CAAAa,MAAA;MACA,KAAA1B,WAAA,QAAA2B,UAAA,CAAA9B,IAAA;MACA2B,OAAA,CAAAI,GAAA,MAAA5B,WAAA;MACA,KAAAF,OAAA;IACA;IACA;IACA6B,WAAAnC,IAAA;MACA,OAAAA,IAAA,CAAAqC,GAAA,CAAAC,IAAA;QACA,MAAAC,IAAA;UACAlB,KAAA,EAAAiB,IAAA,CAAAb,EAAA;UACAe,KAAA,EAAAF,IAAA,CAAAG,MAAA,IAAAH,IAAA,CAAAlC;QACA;QACA;QACA,IAAAsC,KAAA,CAAAC,OAAA,CAAAL,IAAA,CAAAM,QAAA,KAAAN,IAAA,CAAAM,QAAA,CAAAV,MAAA;UACAK,IAAA,CAAAK,QAAA,QAAAT,UAAA,CAAAG,IAAA,CAAAM,QAAA;QACA;QAEA,OAAAL,IAAA;MACA;IACA;IACA,MAAAM,SAAA;MACA,KAAAvC,OAAA;MACA;QAAAD;MAAA,UAAAL,IAAA;MACAgC,OAAA,CAAAI,GAAA,MAAAD,UAAA,CAAA9B,IAAA;MACA,KAAAM,SAAA,QAAAwB,UAAA,CAAA9B,IAAA;MACA,KAAAC,OAAA;IACA;EACA;EACAwC,QAAA;IACA,KAAAD,QAAA;EACA;AACA","ignoreList":[]}]}