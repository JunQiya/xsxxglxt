{"remainingRequest":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\src\\views\\system\\log\\index.vue?vue&type=style&index=0&id=4245a701&scoped=true&lang=css&","dependencies":[{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\src\\views\\system\\log\\index.vue","mtime":1698660664000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678020086000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678020088000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1678020086000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678020084000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1678020088000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50YWJsZSB7CiAgcGFkZGluZzogMzBweDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAwRA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/log","sourcesContent":["<template>\n  <div class=\"router-container\">\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <div class=\"table\">\n          <el-form :inline=\"true\" ref=\"form\" label-width=\"70px\" :model=\"listQuery.entity\">\n            <el-form-item label=\"类名\">\n              <el-input clearable v-model=\"listQuery.entity.clas\" size=\"small\"\n                        placeholder=\"类名\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"方法名\">\n              <el-input clearable v-model=\"listQuery.entity.method\" size=\"small\"\n                        placeholder=\"方法名\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"ip\">\n              <el-input clearable v-model=\"listQuery.entity.ip\" size=\"small\"\n                        placeholder=\"ip\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"操作用户\" v-has-permi=\"['system:user:list']\">\n              <el-select v-model=\"listQuery.entity.userId\" filterable\n                         size=\"small\" placeholder=\"操作用户\" @visible-change=\"getUserList\">\n                <el-option v-for=\"user in userList\"\n                           :key=\"user.id\"\n                           :label=\"user.realName\"\n                           :value=\"user.id\">\n                </el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"url\">\n              <el-input clearable v-model=\"listQuery.entity.url\" size=\"small\"\n                        placeholder=\"url\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"操作时间\">\n              <el-date-picker\n                  v-model=\"listQuery.entity.operateTimeStart\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\"\n                  type=\"datetime\" size=\"small\"\n                  placeholder=\"选择开始时间\">\n              </el-date-picker>\n              -\n              <el-date-picker\n                  v-model=\"listQuery.entity.operateTimeEnd\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\"\n                  type=\"datetime\" size=\"small\"\n                  placeholder=\"选择结束时间\">\n              </el-date-picker>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" style=\"font-size: 16px;\"  @click=\"select\"> 查询</el-button>\n              <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"reset\"> 重置</el-button>\n            </el-form-item>\n          </el-form>\n          <el-table :data=\"pageInfo.list\" v-loading=\"loading\" height=\"348\">\n            <el-table-column label=\"操作用户\" width=\"200\">\n              <template slot-scope=\"scope\">\n                <el-popover\n                    placement=\"top-start\"\n                    width=\"500\"\n                    trigger=\"hover\">\n                  <el-form ref=\"form\" inline :model=\"scope.row.systemUser\" label-width=\"50px\">\n                    <el-form-item label=\"名称 : \">\n                      {{ scope.row.systemUser.realName }}\n                    </el-form-item>\n                    <el-form-item label=\"电话 : \">\n                      {{ scope.row.systemUser.cellphone }}\n                    </el-form-item>\n                    <el-form-item label=\"邮箱 : \">\n                      {{ scope.row.systemUser.email }}\n                    </el-form-item>\n                  </el-form>\n                  <span slot=\"reference\">\n                    {{ scope.row.systemUser.realName }}\n                  </span>\n                </el-popover>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"url\" prop=\"url\" width=\"340\"></el-table-column>\n            <el-table-column label=\"ip\" prop=\"ip\" width=\"200\"></el-table-column>\n            <el-table-column label=\"操作时间\" prop=\"operateTime\" width=\"250\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"140\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button v-has-permi=\"['system:log:query']\"\n                  style=\"font-size: 14px;\"  type=\"primary\" @click=\"showDialog(scope.row.id)\"> 查看\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        <div class=\"page\">\n          <el-pagination\n              background\n              :hide-on-single-page=\"true\"\n              :page-size=\"listQuery.rows\"\n              :page-count=\"pageInfo.pages\"\n              layout=\"->, prev, pager, next, jumper, total, sizes\"\n              :total=\"pageInfo.total\"\n              :current-page.sync=\"pageInfo.pageNum\"\n              @current-change=\"handleCurrentChange\"\n              @size-change=\"handleSizeChange\"\n          >\n          </el-pagination>\n        </div>\n        <div class=\"dialog\">\n          <el-dialog\n              title=\"详情\"\n              :visible.sync=\"dialogVisible\"\n              width=\"50%\"\n              :before-close=\"handleClose\">\n            <el-form ref=\"form\" :model=\"log\" label-width=\"100px\">\n              <el-row :gutter=\"20\">\n                <el-col :span=\"span\">\n                  <el-form-item label=\"操作用户 :\">\n                    <el-popover\n                        placement=\"top-start\"\n                        width=\"500\"\n                        trigger=\"hover\">\n                      <el-form ref=\"form\" inline :model=\"log.systemUser\" label-width=\"50px\">\n                        <el-form-item label=\"名称 : \">\n                          {{ log.systemUser.realName }}\n                        </el-form-item>\n                        <el-form-item label=\"电话 : \">\n                          {{ log.systemUser.cellphone }}\n                        </el-form-item>\n                        <el-form-item label=\"邮箱 : \">\n                          {{ log.systemUser.email }}\n                        </el-form-item>\n                      </el-form>\n                      <span slot=\"reference\">\n                        {{ log.systemUser.realName }}\n                      </span>\n                    </el-popover>\n                  </el-form-item>\n                </el-col>\n                <el-col :span=\"span\">\n                  <el-form-item label=\"类名 :\">\n                    {{ log.clas }}\n                  </el-form-item>\n                </el-col>\n                <el-col :span=\"span\">\n                  <el-form-item label=\"方法名 :\">\n                    {{ log.method }}\n                  </el-form-item>\n                </el-col>\n                <el-col :span=\"span\">\n                  <el-form-item label=\"ip :\">\n                    {{ log.ip }}\n                  </el-form-item>\n                </el-col>\n                <el-col :span=\"span\">\n                  <el-form-item label=\"url :\">\n                    {{ log.url }}\n                  </el-form-item>\n                </el-col>\n                <el-col :span=\"span\">\n                  <el-form-item label=\"操作时间 :\">\n                    {{ log.operateTime }}\n                  </el-form-item>\n                </el-col>\n              </el-row>\n              <el-form-item label=\"描述 :\">\n                {{ log.description }}\n              </el-form-item>\n              <el-form-item label=\"参数 :\">\n                <json-viewer\n                    :value=\"log.param\"\n                    boxed copyable\n                    :expand-depth=\"2\"\n                    :expanded=\"false\">\n                </json-viewer>\n              </el-form-item>\n              <el-form-item label=\"返回值\">\n                <json-viewer\n                    :value=\"log.result\"\n                    boxed copyable\n                    :expand-depth=\"2\"\n                    :expanded=\"false\">\n                </json-viewer>\n              </el-form-item>\n            </el-form>\n            <span slot=\"footer\" class=\"dialog-footer\">\n              <el-button type=\"primary\" size=\"small\" @click=\"dialogVisible = false\">关 闭</el-button>\n            </span>\n          </el-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {list, query} from \"@/api/system/SystemLog\";\nimport {listAll} from \"@/api/system/systemUser\";\nimport JsonViewer from 'vue-json-viewer'\n\nexport default {\n  name: \"index\",\n  components: {JsonViewer},\n  data() {\n    return {\n      span: 12,\n      pageInfo: {},\n      listQuery: {\n        entity: {},\n        page: 1,\n        rows: 10\n      },\n      loading: true,\n      userList: [],\n      dialogVisible: false,\n      log: {\n        id: undefined,\n        userId: undefined,\n        systemUser: {},\n        clas: undefined,\n        method: undefined,\n        ip: undefined,\n        operateTime: undefined,\n        url: undefined,\n        description: undefined,\n        param: undefined\n      }\n    }\n  },\n  methods: {\n    handleClose() {\n      this.dialogVisible = false\n      this.log = {\n        id: undefined,\n        userId: undefined,\n        systemUser: {},\n        clas: undefined,\n        method: undefined,\n        ip: undefined,\n        operateTime: undefined,\n        url: undefined,\n        description: undefined,\n        param: undefined\n      }\n    },\n    async showDialog(id) {\n      const {data} = await query(id)\n      this.log = data\n      this.log.param = JSON.parse(this.log.param)\n      this.log.result = JSON.parse(this.log.result || \"{}\")\n      this.dialogVisible = true\n    },\n    async listData() {\n      this.loading = true\n      const {data} = await list(this.listQuery)\n      this.pageInfo = data\n      this.loading = false\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.listData()\n    },\n    handleSizeChange(val) {\n      this.listQuery.rows = val\n      this.listData()\n    },\n    reset() {\n      this.listQuery.entity = {}\n      this.select()\n    },\n    select() {\n      this.listQuery.page = 1\n      this.listData()\n    },\n    async getUserList() {\n      const {data} = await listAll()\n      this.userList = data\n    }\n  },\n  created() {\n    this.listData()\n  }\n}\n</script>\n\n<style scoped>\n.table {\n  padding: 30px;\n}\n</style>\n"]}]}