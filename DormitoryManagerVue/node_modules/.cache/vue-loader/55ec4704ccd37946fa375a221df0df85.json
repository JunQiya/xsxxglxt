{"remainingRequest":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\src\\views\\manage\\check\\index copy.vue?vue&type=script&lang=js","dependencies":[{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\src\\views\\manage\\check\\index copy.vue","mtime":1743647230063},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1762330415881},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762330398085},{"path":"G:\\2025072398-学生系统管理平台参赛总文件夹\\2025072398-02 素材与源码\\学生系统管理平台\\DormitoryManagerVue\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1762330415853}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogICAgaW1wb3J0IHsgbGlzdCB9IGZyb20gIkAvYXBpL2J1aWxkaW5nIjsNCiAgICBpbXBvcnQgeyBsaXN0QnlCSWQsIHNhdmVPclVwZGF0ZSwgc2NvcmVCeVJpZCB9IGZyb20gIkAvYXBpL3Njb3JlIg0KDQogICAgZXhwb3J0IGRlZmF1bHQgew0KICAgICAgICBuYW1lOiAiaW5kZXgiLA0KICAgICAgICBkYXRhKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBsb2FkaW5nOiB1bmRlZmluZWQsDQogICAgICAgICAgICAgICAgLy8g5a6/6IiN5YiX6KGoDQogICAgICAgICAgICAgICAgcm9vbU9wdGlvbnM6IFtdLA0KICAgICAgICAgICAgICAgIHJvb21WYWx1ZTogJycsDQogICAgICAgICAgICAgICAgLy8g5LiJ57qn6I+c5Y2V5YiX6KGoDQogICAgICAgICAgICAgICAgc2VsZWN0ZWR0Tm9kZTogW10sDQogICAgICAgICAgICAgICAgYmRPcHRpb25zOiBbXSwNCiAgICAgICAgICAgICAgICBzY29yZTogeyBnbG9iYWxfc2NvcmU6IDAsIGJ1aWxkaW5nX3Njb3JlOiAwLCBiZWRfc2NvcmU6IDAsIGluZG9vcl9zY29yZTogMCwgY2Vfc2NvcmU6IDAgfSwNCiAgICAgICAgICAgICAgICBpbWdOYW1lOiAnJw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBtZXRob2RzOiB7DQogICAgICAgICAgICBhc3luYyBoYW5kbGVDaGFuZ2UodmFsdWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOyAvLyDlvIDlkK/liqDovb3nirbmgIENCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNjb3JlQnlSaWQodmFsdWUpLy8g5byC5q2l6I635Y+W5pWw5o2uDQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgIT09IDIwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfor7fmsYLlpLHotKUsY29kZToke3Jlc3BvbnNlLnN0YXR1c0NvZGV9JykNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcmVzcG9uc2UNCiAgICAgICAgICAgICAgICAgICAgLy8g6Kej5p6E6LWL5YC8DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgcm9vbV9pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbF9zY29yZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkaW5nX3Njb3JlLA0KICAgICAgICAgICAgICAgICAgICAgICAgYmVkX3Njb3JlLA0KICAgICAgICAgICAgICAgICAgICAgICAgaW5kb29yX3Njb3JlLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2Vfc2NvcmUsDQogICAgICAgICAgICAgICAgICAgICAgICBpbWdfbmFtZQ0KICAgICAgICAgICAgICAgICAgICB9ID0gZGF0YVswXTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyDlhbbku5blrZfmrrXotYvlgLwNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29yZS5nbG9iYWxfc2NvcmUgPSBnbG9iYWxfc2NvcmU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUuYnVpbGRpbmdfc2NvcmUgPSBidWlsZGluZ19zY29yZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29yZS5iZWRfc2NvcmUgPSBiZWRfc2NvcmU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUuaW5kb29yX3Njb3JlID0gaW5kb29yX3Njb3JlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlLmNlX3Njb3JlID0gY2Vfc2NvcmU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW1nTmFtZSA9IHByb2Nlc3MuZW52LlZVRV9BUFBfSU1HX1BSRUZJWCArIGltZ19uYW1lOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuaVsOiOt+WPluWksei0pTonLCBlcnJvcik7IC8vIOmUmeivr+WkhOeQhg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsX3Njb3JlOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRpbmdfc2NvcmU6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBiZWRfc2NvcmU6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBpbmRvb3Jfc2NvcmU6IDAsDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWdOYW1lID0gJycNCiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsgLy8g5peg6K665oiQ5Yqf5LiO5ZCm6YO95YWz6Zet5Yqg6L2954q25oCBDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLA0KICAgICAgICAgICAgYXN5bmMgYmRDaGFuZ2UodmFsdWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQogICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBsaXN0QnlCSWQodmFsdWVbdmFsdWUubGVuZ3RoIC0gMV0pDQogICAgICAgICAgICAgICAgdGhpcy5yb29tT3B0aW9ucyA9IHRoaXMuZm9ybWF0RGF0YShkYXRhKQ0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMucm9vbU9wdGlvbnMpDQogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvLyDmoLzlvI/ljJbmlbDmja4NCiAgICAgICAgICAgIGZvcm1hdERhdGEobGlzdCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBsaXN0Lm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0ubnVtYmVyIHx8IGl0ZW0ubmFtZQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAvLyDku4XlvZPlrZjlnKjlrZDoioLngrnkuJTkuLrmlbDnu4Tml7bvvIzpgJLlvZLmoLzlvI/ljJblrZDoioLngrkNCiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbS5jaGlsZHJlbikgJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmNoaWxkcmVuID0gdGhpcy5mb3JtYXREYXRhKGl0ZW0uY2hpbGRyZW4pOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgYXN5bmMgbGlzdERhdGEoKSB7DQogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQ0KICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgbGlzdCgpDQogICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5mb3JtYXREYXRhKGRhdGEpKQ0KICAgICAgICAgICAgICAgIHRoaXMuYmRPcHRpb25zID0gdGhpcy5mb3JtYXREYXRhKGRhdGEpDQogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZWQoKSB7DQogICAgICAgICAgICB0aGlzLmxpc3REYXRhKCkNCiAgICAgICAgfQ0KICAgIH0NCg=="},{"version":3,"sources":["index copy.vue"],"names":[],"mappings":";AA6DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index copy.vue","sourceRoot":"src/views/manage/check","sourcesContent":["<template>\r\n    <div class=\"router-container\">\r\n        <div class=\"container\">\r\n            <div class=\"inner_container\" v-loading=\"loading\">\r\n                <div class=\"table\">\r\n                    <div class=\"room_selector\">\r\n                        <div class=\"select_item\">\r\n                            <span>选择楼栋：</span>\r\n                            <el-cascader :options=\"bdOptions\" v-model=\"selectedtNode\" @change=\"bdChange\"></el-cascader>\r\n                        </div>\r\n                        <div class=\"select_item\">\r\n                            <span>选择宿舍：</span>\r\n                            <el-select v-model=\"roomValue\" clearable @change=\"handleChange\">\r\n                                <el-option v-for=\"item in roomOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"table_rate\">\r\n                    <!-- 上方两行 -->\r\n                    <div class=\"rate-item\">\r\n                        <span>整体环境评分：</span>\r\n                        <el-rate v-model=\"score.global_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>建筑设施评分：</span>\r\n                        <el-rate v-model=\"score.building_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <!-- 下方两行 -->\r\n                    <div class=\"rate-item\">\r\n                        <span>床铺卧具评分：</span>\r\n                        <el-rate v-model=\"score.bed_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>室内用品评分：</span>\r\n                        <el-rate v-model=\"score.indoor_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                    <div class=\"rate-item\">\r\n                        <span>综合宿舍评分：</span>\r\n                        <el-rate v-model=\"score.ce_score\" :max=\"10\" disabled show-score text-color=\"#ff9900\"\r\n                            :allow-half=\"true\" score-template=\"{value}分\" />\r\n                    </div>\r\n                </div>\r\n                <div class=\"img_box\">\r\n                    <h1>宿舍照片</h1>\r\n                    <img :src=\"imgName\" alt=\"暂未照片\">\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { list } from \"@/api/building\";\r\n    import { listByBId, saveOrUpdate, scoreByRid } from \"@/api/score\"\r\n\r\n    export default {\r\n        name: \"index\",\r\n        data() {\r\n            return {\r\n                loading: undefined,\r\n                // 宿舍列表\r\n                roomOptions: [],\r\n                roomValue: '',\r\n                // 三级菜单列表\r\n                selectedtNode: [],\r\n                bdOptions: [],\r\n                score: { global_score: 0, building_score: 0, bed_score: 0, indoor_score: 0, ce_score: 0 },\r\n                imgName: ''\r\n            }\r\n        },\r\n        methods: {\r\n            async handleChange(value) {\r\n                this.loading = true; // 开启加载状态\r\n                try {\r\n                    const response = await scoreByRid(value)// 异步获取数据\r\n\r\n                    if (response.statusCode !== 200) {\r\n                        throw new Error('请求失败,code:${response.statusCode}')\r\n                    }\r\n\r\n                    const { data } = response\r\n                    // 解构赋值\r\n                    const {\r\n                        id,\r\n                        room_id,\r\n                        global_score,\r\n                        building_score,\r\n                        bed_score,\r\n                        indoor_score,\r\n                        ce_score,\r\n                        img_name\r\n                    } = data[0];\r\n\r\n                    // 其他字段赋值\r\n                    this.score.global_score = global_score;\r\n                    this.score.building_score = building_score;\r\n                    this.score.bed_score = bed_score;\r\n                    this.score.indoor_score = indoor_score;\r\n                    this.score.ce_score = ce_score;\r\n                    this.imgName = process.env.VUE_APP_IMG_PREFIX + img_name;\r\n                } catch (error) {\r\n                    console.error('分数获取失败:', error); // 错误处理\r\n                    this.score = {\r\n                        global_score: 0,\r\n                        building_score: 0,\r\n                        bed_score: 0,\r\n                        indoor_score: 0,\r\n                    }\r\n                    this.imgName = ''\r\n                } finally {\r\n                    this.loading = false; // 无论成功与否都关闭加载状态\r\n                }\r\n            }\r\n            ,\r\n            async bdChange(value) {\r\n                this.loading = true\r\n                const { data } = await listByBId(value[value.length - 1])\r\n                this.roomOptions = this.formatData(data)\r\n                console.log(this.roomOptions)\r\n                this.loading = false\r\n            },\r\n            // 格式化数据\r\n            formatData(list) {\r\n                return list.map(item => {\r\n                    const node = {\r\n                        value: item.id,\r\n                        label: item.number || item.name\r\n                    };\r\n                    // 仅当存在子节点且为数组时，递归格式化子节点\r\n                    if (Array.isArray(item.children) && item.children.length > 0) {\r\n                        node.children = this.formatData(item.children);\r\n                    }\r\n\r\n                    return node;\r\n                });\r\n            },\r\n            async listData() {\r\n                this.loading = true\r\n                const { data } = await list()\r\n                console.log(this.formatData(data))\r\n                this.bdOptions = this.formatData(data)\r\n                this.loading = false\r\n            },\r\n        },\r\n        created() {\r\n            this.listData()\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .table {\r\n        padding: 10px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        flex: 1.5;\r\n    }\r\n\r\n    .router-container {\r\n        height: 100%;\r\n    }\r\n\r\n    .inner_container {\r\n        display: flex;\r\n    }\r\n\r\n    .room_selector {\r\n        display: flex;\r\n        margin-bottom: 5vh;\r\n    }\r\n\r\n    .select_item {\r\n        margin-right: 2.5vw;\r\n        margin-bottom: 2.5vh;\r\n    }\r\n\r\n    .rate-item {\r\n        display: flex;\r\n        margin-bottom: 5vh;\r\n        margin-left: 1vw;\r\n        font-size: 20px;\r\n        color: rgb(148, 148, 148);\r\n    }\r\n\r\n    .img_box {\r\n        flex: 2;\r\n        height: 70vh;\r\n        min-width: 300px;\r\n    }\r\n\r\n    .img_box h1 {\r\n        margin-bottom: 2vh;\r\n    }\r\n\r\n    .img_box img {\r\n        width: 100%;\r\n        height: 80%;\r\n        object-fit: contain;\r\n    }\r\n\r\n    ::v-deep .el-rate__icon {\r\n        font-size: 2rem !important;\r\n        /* 调整星星大小 */\r\n        margin-right: 5px;\r\n        /* 调整星星间距 */\r\n    }\r\n</style>"]}]}