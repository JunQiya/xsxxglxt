{"remainingRequest":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\src\\views\\manage\\faculty\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\src\\views\\manage\\faculty\\index.vue","mtime":1699273378000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678020084000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1678020086000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678020084000},{"path":"G:\\学生宿舍信息综合管理与服务平台\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1678020088000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7UGFuZSwgU3BsaXRwYW5lc30gZnJvbSAnc3BsaXRwYW5lcycKaW1wb3J0ICdzcGxpdHBhbmVzL2Rpc3Qvc3BsaXRwYW5lcy5jc3MnCmltcG9ydCB7bGlzdCwgcXVlcnksIHNhdmVPclVwZGF0ZSwgZGVsfSBmcm9tICJAL2FwaS9mYWN1bHR5IjsKaW1wb3J0IHtsaXN0IGFzIGxpc3RTdHVkZW50fSBmcm9tICdAL2FwaS9zdHVkZW50JwppbXBvcnQgVHJlZVNlbGVjdCBmcm9tICdAcmlvcGhhZS92dWUtdHJlZXNlbGVjdCcKaW1wb3J0ICJAcmlvcGhhZS92dWUtdHJlZXNlbGVjdC9kaXN0L3Z1ZS10cmVlc2VsZWN0LmNzcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBjb21wb25lbnRzOiB7IFNwbGl0cGFuZXMsIFBhbmUsIFRyZWVTZWxlY3QgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nVmlzaWJsZTE6IGZhbHNlLAogICAgICBwYWdlSW5mbzogW10sCiAgICAgIGxpc3RRdWVyeTogewogICAgICAgIGVudGl0eTp7fSwKICAgICAgICByb3dzOjEwLAogICAgICAgIHBhZ2U6MQogICAgICB9LAogICAgICBsaXN0OltdLAogICAgICBzZWxlY3ROb2RlOiB1bmRlZmluZWQsCiAgICAgIGZhY3VsdHk6e30sCiAgICAgIGV4cGFuZEtleXM6IFtdLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0sCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBydWxlczp7CiAgICAgICAgbmFtZToge3JlcXVpcmU6IHRydWUsbWVzc2FnZTogJ+WQjeensOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucm93cyA9IHZhbAogICAgICB0aGlzLmxpc3RTdHVkZW50KCkKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgewogICAgICB0aGlzLmxpc3RRdWVyeS5wYWdlID0gdmFsCiAgICAgIHRoaXMubGlzdFN0dWRlbnQoKQogICAgfSwKICAgIGFzeW5jIGxpc3RTdHVkZW50KGlkKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5LmVudGl0eS5mYWN1bHR5SWQgPSBpZAogICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBsaXN0U3R1ZGVudCh0aGlzLmxpc3RRdWVyeSkKICAgICAgdGhpcy5wYWdlSW5mbyA9IGRhdGEKICAgIH0sCiAgICBzaG93RGlhbG9nMShpZCkgewogICAgICB0aGlzLmxpc3RTdHVkZW50KGlkKQogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUxID0gdHJ1ZQogICAgfSwKICAgIGhhbmRsZUNsb3NlMSgpIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlMSA9IGZhbHNlCiAgICAgIHRoaXMuc3R1ZGVudExpc3QgPSBbXQogICAgICB0aGlzLmxpc3RRdWVyeSA9IHsKICAgICAgICBlbnRpdHk6e30sCiAgICAgICAgcm93czoxMCwKICAgICAgICBwYWdlOjEKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxpc3REYXRhKCkgewogICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBsaXN0KCkKICAgICAgdGhpcy5saXN0ID0gZGF0YQogICAgICBmb3IgKGxldCBpIG9mIHRoaXMubGlzdCkgewogICAgICAgIHRoaXMuZXhwYW5kS2V5cy5wdXNoKGkuaWQpCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBoYW5kbGVOb2RlQ2xpY2sobm9kZSkgewogICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBxdWVyeShub2RlLmlkKQogICAgICB0aGlzLnNlbGVjdE5vZGUgPSBkYXRhCiAgICB9LAogICAgc2hvd0RpYWxvZygpIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIGhhbmRsZUNsb3NlKCkgewogICAgICB0aGlzLmZhY3VsdHkgPSB7fQogICAgICB0aGlzLnNlbGVjdE5vZGUgPSB1bmRlZmluZWQKICAgICAgdGhpcy4kcmVmc1snZm9ybSddLnJlc2V0RmllbGRzKCkKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgIH0sCiAgICBkZWwoaWQpIHsKICAgICAgdGhpcy4kY29uZmlybSgi5piv5ZCm56Gu5a6a5Yig6Zmk5pS56IqC54K55Lul5Y+K5a2Q6IqC54K5IiwgIuitpuWRiiIsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIGRlbChpZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKnyEnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnNlbGVjdE5vZGUgPSB1bmRlZmluZWQKICAgICAgICAgICAgdGhpcy5saXN0RGF0YSgpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCiAgICBzYXZlT3JVcGRhdGUoZikgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXMKICAgICAgbGV0IGRhdGEgPSB0aGlzLnNlbGVjdE5vZGUKICAgICAgaWYgKGYpIHsKICAgICAgICBkYXRhID0gdGhpcy5mYWN1bHR5CiAgICAgIH0KICAgICAgdGhpcy4kcmVmc1snZm9ybSddLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgc2F2ZU9yVXBkYXRlKGRhdGEpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVDbG9zZSgpCiAgICAgICAgICAgICAgX3RoaXMubGlzdERhdGEoKQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+ato+ehruWhq+WGmeWPguaVsCcsCiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBub3JtYWxpemVyKG5vZGUpIHsKICAgICAgaWYgKG5vZGUuY2hpbGRyZW4gJiYgIW5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgZGVsZXRlIG5vZGUuY2hpbGRyZW47CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogbm9kZS5pZCwKICAgICAgICBsYWJlbDogbm9kZS5uYW1lLAogICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuCiAgICAgIH07CiAgICB9LAogICAgcmVuZGVyQ29udGVudChoLCB7IG5vZGUsIGRhdGEgfSkgewogICAgICByZXR1cm4gKAogICAgICAgICAgPHNwYW4gY2xhc3M9ImN1c3RvbS10cmVlLW5vZGUiPgogICAgICAgICAgICA8c3Bhbj57bm9kZS5sYWJlbH08L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MTJweDtjb2xvcjojQzVDNUM1Ij4KICAgICAgICAgICAgICB7ZGF0YS5zdHVkZW50TnVtfQogICAgICAgICAgICA8L3NwYW4+CiAgICAgICAgICA8L3NwYW4+KTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxpc3REYXRhKCkKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAoHA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/manage/faculty","sourcesContent":["<template>\n  <div class=\"router-container\">\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <splitpanes style=\"height: 550px\">\n          <pane min-size=\"20\" size=\"30\">\n            <el-button v-has-permi=\"['faculty:save']\" type=\"success\" style=\"font-size: 14px;margin-bottom: 5px;\"  @click=\"showDialog\"> 添加</el-button>\n            <div style=\"width: 80%;\">\n              <el-tree @node-click=\"handleNodeClick\"\n                       :expand-on-click-node=\"false\" :default-expanded-keys=\"expandKeys\"\n                       :data=\"list\"\n                       node-key=\"id\" :render-content=\"renderContent\"\n                       :props=\"defaultProps\">\n              </el-tree>\n            </div>\n          </pane>\n          <pane min-size=\"30\">\n            <div style=\"width: 70%;margin: 0 auto\">\n              <el-form v-if=\"selectNode\" ref=\"form\" :model=\"selectNode\" :rules=\"rules\" label-width=\"80px\">\n                <el-form-item label=\"上级菜单\">\n                  <tree-select\n                      v-model=\"selectNode.parentId\"\n                      :options=\"list\"\n                      :normalizer=\"normalizer\"\n                      :show-count=\"true\"\n                      placeholder=\"选择上级菜单\">\n                  </tree-select>\n                </el-form-item>\n                <el-form-item label=\"学院名称\" prop=\"name\">\n                  <el-input clearable v-model=\"selectNode.name\"\n                            placeholder=\"学院名称\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"排序序号\" prop=\"orderNum\">\n                  <el-input-number v-model=\"selectNode.orderNum\"\n                            placeholder=\"排序序号\"></el-input-number>\n                </el-form-item>\n                <el-form-item>\n                  <el-button type=\"success\" style=\"font-size: 16px;\"  v-has-permi=\"['faculty:update']\" @click=\"saveOrUpdate(0)\"> 修改</el-button>\n                  <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"handleNodeClick(selectNode)\"> 重置</el-button>\n                  <br>\n                  <el-button type=\"danger\" style=\"font-size: 16px;\"  v-has-permi=\"['faculty:delete']\" @click=\"del(selectNode.id)\"> 删除</el-button>\n                  <el-button type=\"primary\" style=\"font-size: 16px;\"  v-has-permi=\"['student:list']\" @click=\"showDialog1(selectNode.id)\"> 查看学生</el-button>\n                </el-form-item>\n              </el-form>\n            </div>\n          </pane>\n        </splitpanes>\n        <div>\n          <el-dialog\n              title=\"添加学院\"\n              :visible.sync=\"dialogVisible\"\n              width=\"40%\"\n              @closed=\"handleClose\"\n          >\n            <el-form ref=\"form\" :model=\"faculty\" :rules=\"rules\" label-width=\"80px\">\n              <el-form-item label=\"上级学院\">\n                <tree-select\n                    v-model=\"faculty.parentId\"\n                    :options=\"list\"\n                    :normalizer=\"normalizer\"\n                    :show-count=\"true\"\n                    placeholder=\"选择上级学院\">\n                </tree-select>\n              </el-form-item>\n              <el-form-item label=\"学院名称\" prop=\"name\">\n                <el-input clearable v-model=\"faculty.name\"\n                          placeholder=\"学院名称\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"排序序号\" prop=\"orderNum\">\n                <el-input-number v-model=\"faculty.orderNum\"\n                                 placeholder=\"排序序号\"></el-input-number>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" v-has-permi=\"['faculty:save']\" @click=\"saveOrUpdate(1)\"> 添加</el-button>\n              </el-form-item>\n            </el-form>\n          </el-dialog>\n          <el-dialog title=\"学生\"\n                     :visible.sync=\"dialogVisible1\"\n                     width=\"65%\"\n                     @closed=\"handleClose1\">\n            <el-table :data=\"pageInfo.list\" height=\"430\">\n              <el-table-column label=\"姓名\" prop=\"name\" width=\"100\"></el-table-column>\n              <el-table-column label=\"学号\" prop=\"number\" width=\"160\"></el-table-column>\n              <el-table-column label=\"班级\" prop=\"faculty.name\" width=\"160\"></el-table-column>\n              <el-table-column label=\"宿舍\" prop=\"room.number\" width=\"120\"></el-table-column>\n              <el-table-column label=\"电话\" prop=\"phone\" width=\"150\"></el-table-column>\n              <el-table-column label=\"注册日期\" prop=\"registrationDate\" width=\"120\"></el-table-column>\n              <el-table-column label=\"是否在寝\" width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span style=\"color: #67C23A\" v-if=\"!scope.row.isLeave\">是</span>\n                  <span style=\"color: #909399\" v-else>否</span>\n                </template>\n              </el-table-column>\n            </el-table>\n            <div class=\"page\">\n              <el-pagination\n                  background\n                  :page-size=\"listQuery.rows\"\n                  :page-count=\"pageInfo.pages\"\n                  layout=\"->, prev, pager, next, jumper, total, sizes\"\n                  :total=\"pageInfo.total\"\n                  :current-page.sync=\"pageInfo.pageNum\"\n                  @current-change=\"handleCurrentChange\"\n                  @size-change=\"handleSizeChange\"\n              >\n              </el-pagination>\n            </div>\n          </el-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {Pane, Splitpanes} from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport {list, query, saveOrUpdate, del} from \"@/api/faculty\";\nimport {list as listStudent} from '@/api/student'\nimport TreeSelect from '@riophae/vue-treeselect'\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\n\nexport default {\n  name: \"index\",\n  components: { Splitpanes, Pane, TreeSelect },\n  data() {\n    return {\n      dialogVisible1: false,\n      pageInfo: [],\n      listQuery: {\n        entity:{},\n        rows:10,\n        page:1\n      },\n      list:[],\n      selectNode: undefined,\n      faculty:{},\n      expandKeys: [],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      dialogVisible: false,\n      rules:{\n        name: {require: true,message: '名称不能为空', trigger: 'blur'}\n      }\n    }\n  },\n  methods: {\n    handleSizeChange(val) {\n      this.listQuery.rows = val\n      this.listStudent()\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.listStudent()\n    },\n    async listStudent(id) {\n      this.listQuery.entity.facultyId = id\n      const {data} = await listStudent(this.listQuery)\n      this.pageInfo = data\n    },\n    showDialog1(id) {\n      this.listStudent(id)\n      this.dialogVisible1 = true\n    },\n    handleClose1() {\n      this.dialogVisible1 = false\n      this.studentList = []\n      this.listQuery = {\n        entity:{},\n        rows:10,\n        page:1\n      }\n    },\n    async listData() {\n      const {data} = await list()\n      this.list = data\n      for (let i of this.list) {\n        this.expandKeys.push(i.id)\n      }\n    },\n    async handleNodeClick(node) {\n      const {data} = await query(node.id)\n      this.selectNode = data\n    },\n    showDialog() {\n      this.dialogVisible = true\n    },\n    handleClose() {\n      this.faculty = {}\n      this.selectNode = undefined\n      this.$refs['form'].resetFields()\n      this.dialogVisible = false\n    },\n    del(id) {\n      this.$confirm(\"是否确定删除改节点以及子节点\", \"警告\", {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        del(id).then((res) => {\n          if (res.statusCode === 200) {\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n            this.selectNode = undefined\n            this.listData()\n          }\n        })\n      })\n    },\n    saveOrUpdate(f) {\n      const _this = this\n      let data = this.selectNode\n      if (f) {\n        data = this.faculty\n      }\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          saveOrUpdate(data).then(res => {\n            if (res.statusCode === 200) {\n              this.$message({\n                message: res.msg,\n                type: 'success'\n              });\n              _this.handleClose()\n              _this.listData()\n            }\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      })\n    },\n    normalizer(node) {\n      if (node.children && !node.children.length) {\n        delete node.children;\n      }\n      return {\n        id: node.id,\n        label: node.name,\n        children: node.children\n      };\n    },\n    renderContent(h, { node, data }) {\n      return (\n          <span class=\"custom-tree-node\">\n            <span>{node.label}</span>\n            <span style=\"font-size:12px;color:#C5C5C5\">\n              {data.studentNum}\n            </span>\n          </span>);\n    }\n  },\n  created() {\n    this.listData()\n  }\n}\n</script>\n\n<style>\n.splitpanes__splitter {\n  width: 6px;\n  background: #F5F5F5;\n  position: relative;\n}\n.splitpanes__splitter:before,  .splitpanes__splitter:after{\n  background-color: rgba(0,0,0,.15);\n  content: '';\n  width: 1px;\n  height: 30px;\n  float: left;\n  position: absolute;\n  display: block;\n  top: 50%;\n  left: 50%;\n  margin-top: -15px;\n}\n.custom-tree-node {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 14px;\n  padding-right: 8px;\n}\n.splitpanes__splitter:after {\n  margin-left: 1px;\n}\n.splitpanes__splitter:before {\n  margin-left: -2px;\n}\n.page {\n  margin-top: 5px;\n}\n</style>\n"]}]}