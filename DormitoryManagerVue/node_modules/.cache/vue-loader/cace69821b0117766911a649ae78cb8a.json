{"remainingRequest":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\src\\views\\system\\role\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\src\\views\\system\\role\\index.vue","mtime":1712740387000},{"path":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1712740387000},{"path":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1712740387000},{"path":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1712740387000},{"path":"E:\\学生宿舍信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1712740387000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7ZGVsLCBsaXN0LCBxdWVyeSwgc2F2ZU9yVXBkYXRlfSBmcm9tICJAL2FwaS9zeXN0ZW0vc3lzdGVtUm9sZSI7CmltcG9ydCB7bGlzdFRyZWV9IGZyb20gIi4uLy4uLy4uL2FwaS9zeXN0ZW0vU3lzdGVtRnVuY3Rpb24iOwppbXBvcnQgTXlUcmVlIGZyb20gJ0AvY29tcG9uZW50cy9NeVRyZWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBjb21wb25lbnRzOiB7CiAgICBNeVRyZWUKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBwYWdlSW5mbzoge30sCiAgICAgIGxpc3RRdWVyeTogewogICAgICAgIGVudGl0eToge30sCiAgICAgICAgcGFnZTogMSwKICAgICAgICByb3dzOiAxMAogICAgICB9LAogICAgICByb2xlOiB7CiAgICAgICAgaWQ6IHVuZGVmaW5lZCwKICAgICAgICBuYW1lOiAnJywKICAgICAgICBmdW5jdGlvbklkczogW10KICAgICAgfSwKICAgICAgbGlzdFRyZWU6IFtdLAogICAgICBkaWFsb2dUaXRsZTogJycsCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBydWxlczogewogICAgICAgIG5hbWU6IHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+WQjeensOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2F2ZU9yVXBkYXRlKCkgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXMKICAgICAgdGhpcy4kcmVmc1snc2F2ZU9yVXBkYXRlRm9ybSddLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgc2F2ZU9yVXBkYXRlKHRoaXMucm9sZSkudGhlbihyZXMgPT4gewogICAgICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywKICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF90aGlzLmhhbmRsZUNsb3NlKCkKICAgICAgICAgICAgICBfdGhpcy5saXN0RGF0YSgpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn6K+35q2j56Gu5aGr5YaZ5Y+C5pWwJywKICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGRlbChpZCkgewogICAgICBkZWwoaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmxpc3REYXRhKCkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgc2VsZWN0KCkgewogICAgICB0aGlzLmxpc3RRdWVyeS5wYWdlID0gMQogICAgICB0aGlzLmxpc3REYXRhKCkKICAgIH0sCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5saXN0UXVlcnkuZW50aXR5ID0ge30KICAgICAgdGhpcy5zZWxlY3QoKQogICAgfSwKICAgIGhhbmRsZUNsb3NlKCkgewogICAgICB0aGlzLnJvbGUgPSB7CiAgICAgICAgaWQ6IHVuZGVmaW5lZCwKICAgICAgICBuYW1lOiAnJywKICAgICAgICBmdW5jdGlvbklkczogW10KICAgICAgfQogICAgICB0aGlzLmxpc3RUcmVlID0gW10KICAgICAgdGhpcy4kcmVmc1snc2F2ZU9yVXBkYXRlRm9ybSddLnJlc2V0RmllbGRzKCkKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgIH0sCiAgICBhc3luYyBzaG93RGlhbG9nKGlkKSB7CiAgICAgIHRoaXMuZGlhbG9nVGl0bGUgPSAi5re75Yqg6KeS6ImyIgogICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBsaXN0VHJlZSgpOwogICAgICB0aGlzLmxpc3RUcmVlID0gZGF0YQogICAgICBpZiAoaWQpIHsKICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gIuS/ruaUueinkuiJsiIKICAgICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBxdWVyeShpZCkKICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICAgICAgdGhpcy5yb2xlID0gZGF0YQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBsaXN0RGF0YSgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBsaXN0KHRoaXMubGlzdFF1ZXJ5KQogICAgICB0aGlzLnBhZ2VJbmZvID0gZGF0YQogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgfSwKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5LnBhZ2UgPSB2YWwKICAgICAgdGhpcy5saXN0RGF0YSgpCiAgICB9LAogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucm93cyA9IHZhbAogICAgICB0aGlzLmxpc3REYXRhKCkKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxpc3REYXRhKCkKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgFA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/role","sourcesContent":["<template>\n  <div class=\"router-container\">\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <div class=\"table\">\n          <el-form :inline=\"true\" ref=\"form\" :model=\"listQuery.entity\">\n            <el-form-item label=\"角色名称\">\n              <el-input clearable v-model=\"listQuery.entity.name\" \n                        placeholder=\"角色名称\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" style=\"font-size: 16px;\"  @click=\"select\"> 查询</el-button>\n              <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"reset\"> 重置</el-button>\n              <el-button v-has-permi=\"['system:role:save']\" @click=\"showDialog(undefined)\"\n                   style=\"font-size: 16px;\"  type=\"primary\"> 新增\n              </el-button>\n            </el-form-item>\n          </el-form>\n          <el-table :data=\"pageInfo.list\" v-loading=\"loading\" height=\"410\">\n            <el-table-column label=\"序号\">\n              <template slot-scope=\"scope\">{{ (listQuery.page - 1) * (listQuery.rows) + scope.$index + 1 }}</template>\n            </el-table-column>\n            <el-table-column label=\"名称\" prop=\"name\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"240\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button v-has-permi=\"['system:role:query']\"\n                     style=\"font-size: 14px;\"  type=\"primary\" @click=\"showDialog(scope.row.id)\"> 详情\n                </el-button>\n                <template>\n                  <el-popconfirm title=\"确定删除吗？\" @confirm=\"del(scope.row.id)\">\n                    <el-button style=\"margin-left: 8px;font-size: 12px;\" v-has-permi=\"['system:role:delete']\"\n                               slot=\"reference\"  type=\"danger\"> 删除\n                    </el-button>\n                  </el-popconfirm>\n                </template>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        <div class=\"page\">\n          <el-pagination\n              background\n              :page-size=\"listQuery.rows\"\n              :page-count=\"pageInfo.pages\"\n              layout=\"->, prev, pager, next, jumper, total, sizes\"\n              :total=\"pageInfo.total\"\n              :current-page.sync=\"pageInfo.pageNum\"\n              @current-change=\"handleCurrentChange\"\n              @size-change=\"handleSizeChange\"\n          >\n          </el-pagination>\n        </div>\n        <div class=\"dialog\">\n          <el-dialog\n              :title=\"dialogTitle\"\n              :visible.sync=\"dialogVisible\"\n              width=\"45%\"\n              @closed=\"handleClose\"\n          >\n            <el-form ref=\"saveOrUpdateForm\" :rules=\"rules\" :model=\"role\" label-width=\"80px\">\n              <el-form-item label=\"名称\" prop=\"name\">\n                <el-input v-model=\"role.name\" placeholder=\"输入名称\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"菜单\" prop=\"functionIds\">\n                <my-tree :tree=\"listTree\" :checked=\"role.functionIds\"></my-tree>\n              </el-form-item>\n            </el-form>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                            <el-button type=\"danger\" @click=\"handleClose\"> 取 消</el-button>\n                            <el-button type=\"primary\" @click=\"saveOrUpdate\"\n                                       v-has-permi=\"['system:role:update','system:role:save']\"> 保 存</el-button>\n                          </span>\n          </el-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {del, list, query, saveOrUpdate} from \"@/api/system/systemRole\";\nimport {listTree} from \"../../../api/system/SystemFunction\";\nimport MyTree from '@/components/MyTree'\n\nexport default {\n  name: \"index\",\n  components: {\n    MyTree\n  },\n  data() {\n    return {\n      loading: true,\n      pageInfo: {},\n      listQuery: {\n        entity: {},\n        page: 1,\n        rows: 10\n      },\n      role: {\n        id: undefined,\n        name: '',\n        functionIds: []\n      },\n      listTree: [],\n      dialogTitle: '',\n      dialogVisible: false,\n      rules: {\n        name: {required: true, message: '名称不能为空', trigger: 'blur'}\n      }\n    }\n  },\n  methods: {\n    saveOrUpdate() {\n      const _this = this\n      this.$refs['saveOrUpdateForm'].validate((valid) => {\n        if (valid) {\n          saveOrUpdate(this.role).then(res => {\n            if (res.statusCode === 200) {\n              this.$message({\n                message: res.msg,\n                type: 'success'\n              });\n              _this.handleClose()\n              _this.listData()\n            }\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      })\n    },\n    del(id) {\n      del(id).then(res => {\n        if (res.statusCode === 200) {\n          this.$message({\n            message: res.msg,\n            type: 'success'\n          });\n          this.listData()\n        }\n      })\n    },\n    select() {\n      this.listQuery.page = 1\n      this.listData()\n    },\n    reset() {\n      this.listQuery.entity = {}\n      this.select()\n    },\n    handleClose() {\n      this.role = {\n        id: undefined,\n        name: '',\n        functionIds: []\n      }\n      this.listTree = []\n      this.$refs['saveOrUpdateForm'].resetFields()\n      this.dialogVisible = false\n    },\n    async showDialog(id) {\n      this.dialogTitle = \"添加角色\"\n      const {data} = await listTree();\n      this.listTree = data\n      if (id) {\n        this.dialogTitle = \"修改角色\"\n        const {data} = await query(id)\n        if (data) {\n          this.dialogVisible = true\n          this.role = data\n        }\n      } else {\n        this.dialogVisible = true\n      }\n    },\n    async listData() {\n      this.loading = true\n      const {data} = await list(this.listQuery)\n      this.pageInfo = data\n      this.loading = false\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.listData()\n    },\n    handleSizeChange(val) {\n      this.listQuery.rows = val\n      this.listData()\n    }\n  },\n  created() {\n    this.listData()\n  }\n}\n</script>\n\n<style scoped>\n.table {\n  padding: 30px;\n}\n\n</style>\n"]}]}