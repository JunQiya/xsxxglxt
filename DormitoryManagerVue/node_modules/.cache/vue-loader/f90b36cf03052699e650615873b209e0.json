{"remainingRequest":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\src\\views\\manage\\faculty\\index.vue?vue&type=style&index=0&id=02ccc252&lang=css","dependencies":[{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\src\\views\\manage\\faculty\\index.vue","mtime":1699273378000},{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678020086000},{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1712129911071},{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1678020086000},{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678020084000},{"path":"E:\\桌面\\学生信息管理系统\\DormitoryManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1712129911065}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5zcGxpdHBhbmVzX19zcGxpdHRlciB7CiAgd2lkdGg6IDZweDsKICBiYWNrZ3JvdW5kOiAjRjVGNUY1OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQouc3BsaXRwYW5lc19fc3BsaXR0ZXI6YmVmb3JlLCAgLnNwbGl0cGFuZXNfX3NwbGl0dGVyOmFmdGVyewogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsLjE1KTsKICBjb250ZW50OiAnJzsKICB3aWR0aDogMXB4OwogIGhlaWdodDogMzBweDsKICBmbG9hdDogbGVmdDsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgZGlzcGxheTogYmxvY2s7CiAgdG9wOiA1MCU7CiAgbGVmdDogNTAlOwogIG1hcmdpbi10b3A6IC0xNXB4Owp9Ci5jdXN0b20tdHJlZS1ub2RlIHsKICBmbGV4OiAxOwogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgZm9udC1zaXplOiAxNHB4OwogIHBhZGRpbmctcmlnaHQ6IDhweDsKfQouc3BsaXRwYW5lc19fc3BsaXR0ZXI6YWZ0ZXIgewogIG1hcmdpbi1sZWZ0OiAxcHg7Cn0KLnNwbGl0cGFuZXNfX3NwbGl0dGVyOmJlZm9yZSB7CiAgbWFyZ2luLWxlZnQ6IC0ycHg7Cn0KLnBhZ2UgewogIG1hcmdpbi10b3A6IDVweDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA4QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/manage/faculty","sourcesContent":["<template>\n  <div class=\"router-container\">\n    <div class=\"container\">\n      <div class=\"inner_container\">\n        <splitpanes style=\"height: 550px\">\n          <pane min-size=\"20\" size=\"30\">\n            <el-button v-has-permi=\"['faculty:save']\" type=\"success\" style=\"font-size: 14px;margin-bottom: 5px;\"  @click=\"showDialog\"> 添加</el-button>\n            <div style=\"width: 80%;\">\n              <el-tree @node-click=\"handleNodeClick\"\n                       :expand-on-click-node=\"false\" :default-expanded-keys=\"expandKeys\"\n                       :data=\"list\"\n                       node-key=\"id\" :render-content=\"renderContent\"\n                       :props=\"defaultProps\">\n              </el-tree>\n            </div>\n          </pane>\n          <pane min-size=\"30\">\n            <div style=\"width: 70%;margin: 0 auto\">\n              <el-form v-if=\"selectNode\" ref=\"form\" :model=\"selectNode\" :rules=\"rules\" label-width=\"80px\">\n                <el-form-item label=\"上级菜单\">\n                  <tree-select\n                      v-model=\"selectNode.parentId\"\n                      :options=\"list\"\n                      :normalizer=\"normalizer\"\n                      :show-count=\"true\"\n                      placeholder=\"选择上级菜单\">\n                  </tree-select>\n                </el-form-item>\n                <el-form-item label=\"学院名称\" prop=\"name\">\n                  <el-input clearable v-model=\"selectNode.name\"\n                            placeholder=\"学院名称\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"排序序号\" prop=\"orderNum\">\n                  <el-input-number v-model=\"selectNode.orderNum\"\n                            placeholder=\"排序序号\"></el-input-number>\n                </el-form-item>\n                <el-form-item>\n                  <el-button type=\"success\" style=\"font-size: 16px;\"  v-has-permi=\"['faculty:update']\" @click=\"saveOrUpdate(0)\"> 修改</el-button>\n                  <el-button type=\"warning\" style=\"font-size: 16px;\"  @click=\"handleNodeClick(selectNode)\"> 重置</el-button>\n                  <br>\n                  <el-button type=\"danger\" style=\"font-size: 16px;\"  v-has-permi=\"['faculty:delete']\" @click=\"del(selectNode.id)\"> 删除</el-button>\n                  <el-button type=\"primary\" style=\"font-size: 16px;\"  v-has-permi=\"['student:list']\" @click=\"showDialog1(selectNode.id)\"> 查看学生</el-button>\n                </el-form-item>\n              </el-form>\n            </div>\n          </pane>\n        </splitpanes>\n        <div>\n          <el-dialog\n              title=\"添加学院\"\n              :visible.sync=\"dialogVisible\"\n              width=\"40%\"\n              @closed=\"handleClose\"\n          >\n            <el-form ref=\"form\" :model=\"faculty\" :rules=\"rules\" label-width=\"80px\">\n              <el-form-item label=\"上级学院\">\n                <tree-select\n                    v-model=\"faculty.parentId\"\n                    :options=\"list\"\n                    :normalizer=\"normalizer\"\n                    :show-count=\"true\"\n                    placeholder=\"选择上级学院\">\n                </tree-select>\n              </el-form-item>\n              <el-form-item label=\"学院名称\" prop=\"name\">\n                <el-input clearable v-model=\"faculty.name\"\n                          placeholder=\"学院名称\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"排序序号\" prop=\"orderNum\">\n                <el-input-number v-model=\"faculty.orderNum\"\n                                 placeholder=\"排序序号\"></el-input-number>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" v-has-permi=\"['faculty:save']\" @click=\"saveOrUpdate(1)\"> 添加</el-button>\n              </el-form-item>\n            </el-form>\n          </el-dialog>\n          <el-dialog title=\"学生\"\n                     :visible.sync=\"dialogVisible1\"\n                     width=\"65%\"\n                     @closed=\"handleClose1\">\n            <el-table :data=\"pageInfo.list\" height=\"430\">\n              <el-table-column label=\"姓名\" prop=\"name\" width=\"100\"></el-table-column>\n              <el-table-column label=\"学号\" prop=\"number\" width=\"160\"></el-table-column>\n              <el-table-column label=\"班级\" prop=\"faculty.name\" width=\"160\"></el-table-column>\n              <el-table-column label=\"宿舍\" prop=\"room.number\" width=\"120\"></el-table-column>\n              <el-table-column label=\"电话\" prop=\"phone\" width=\"150\"></el-table-column>\n              <el-table-column label=\"注册日期\" prop=\"registrationDate\" width=\"120\"></el-table-column>\n              <el-table-column label=\"是否在寝\" width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span style=\"color: #67C23A\" v-if=\"!scope.row.isLeave\">是</span>\n                  <span style=\"color: #909399\" v-else>否</span>\n                </template>\n              </el-table-column>\n            </el-table>\n            <div class=\"page\">\n              <el-pagination\n                  background\n                  :page-size=\"listQuery.rows\"\n                  :page-count=\"pageInfo.pages\"\n                  layout=\"->, prev, pager, next, jumper, total, sizes\"\n                  :total=\"pageInfo.total\"\n                  :current-page.sync=\"pageInfo.pageNum\"\n                  @current-change=\"handleCurrentChange\"\n                  @size-change=\"handleSizeChange\"\n              >\n              </el-pagination>\n            </div>\n          </el-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {Pane, Splitpanes} from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport {list, query, saveOrUpdate, del} from \"@/api/faculty\";\nimport {list as listStudent} from '@/api/student'\nimport TreeSelect from '@riophae/vue-treeselect'\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\n\nexport default {\n  name: \"index\",\n  components: { Splitpanes, Pane, TreeSelect },\n  data() {\n    return {\n      dialogVisible1: false,\n      pageInfo: [],\n      listQuery: {\n        entity:{},\n        rows:10,\n        page:1\n      },\n      list:[],\n      selectNode: undefined,\n      faculty:{},\n      expandKeys: [],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      dialogVisible: false,\n      rules:{\n        name: {require: true,message: '名称不能为空', trigger: 'blur'}\n      }\n    }\n  },\n  methods: {\n    handleSizeChange(val) {\n      this.listQuery.rows = val\n      this.listStudent()\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.listStudent()\n    },\n    async listStudent(id) {\n      this.listQuery.entity.facultyId = id\n      const {data} = await listStudent(this.listQuery)\n      this.pageInfo = data\n    },\n    showDialog1(id) {\n      this.listStudent(id)\n      this.dialogVisible1 = true\n    },\n    handleClose1() {\n      this.dialogVisible1 = false\n      this.studentList = []\n      this.listQuery = {\n        entity:{},\n        rows:10,\n        page:1\n      }\n    },\n    async listData() {\n      const {data} = await list()\n      this.list = data\n      for (let i of this.list) {\n        this.expandKeys.push(i.id)\n      }\n    },\n    async handleNodeClick(node) {\n      const {data} = await query(node.id)\n      this.selectNode = data\n    },\n    showDialog() {\n      this.dialogVisible = true\n    },\n    handleClose() {\n      this.faculty = {}\n      this.selectNode = undefined\n      this.$refs['form'].resetFields()\n      this.dialogVisible = false\n    },\n    del(id) {\n      this.$confirm(\"是否确定删除改节点以及子节点\", \"警告\", {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        del(id).then((res) => {\n          if (res.statusCode === 200) {\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n            this.selectNode = undefined\n            this.listData()\n          }\n        })\n      })\n    },\n    saveOrUpdate(f) {\n      const _this = this\n      let data = this.selectNode\n      if (f) {\n        data = this.faculty\n      }\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          saveOrUpdate(data).then(res => {\n            if (res.statusCode === 200) {\n              this.$message({\n                message: res.msg,\n                type: 'success'\n              });\n              _this.handleClose()\n              _this.listData()\n            }\n          })\n        } else {\n          this.$message({\n            message: '请正确填写参数',\n            type: 'error'\n          });\n          return false;\n        }\n      })\n    },\n    normalizer(node) {\n      if (node.children && !node.children.length) {\n        delete node.children;\n      }\n      return {\n        id: node.id,\n        label: node.name,\n        children: node.children\n      };\n    },\n    renderContent(h, { node, data }) {\n      return (\n          <span class=\"custom-tree-node\">\n            <span>{node.label}</span>\n            <span style=\"font-size:12px;color:#C5C5C5\">\n              {data.studentNum}\n            </span>\n          </span>);\n    }\n  },\n  created() {\n    this.listData()\n  }\n}\n</script>\n\n<style>\n.splitpanes__splitter {\n  width: 6px;\n  background: #F5F5F5;\n  position: relative;\n}\n.splitpanes__splitter:before,  .splitpanes__splitter:after{\n  background-color: rgba(0,0,0,.15);\n  content: '';\n  width: 1px;\n  height: 30px;\n  float: left;\n  position: absolute;\n  display: block;\n  top: 50%;\n  left: 50%;\n  margin-top: -15px;\n}\n.custom-tree-node {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 14px;\n  padding-right: 8px;\n}\n.splitpanes__splitter:after {\n  margin-left: 1px;\n}\n.splitpanes__splitter:before {\n  margin-left: -2px;\n}\n.page {\n  margin-top: 5px;\n}\n</style>\n"]}]}